(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerRecord = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerRecord=(()=>{var Vc=Object.create;var gn=Object.defineProperty;var qc=Object.getOwnPropertyDescriptor;var zc=Object.getOwnPropertyNames;var Hc=Object.getPrototypeOf,Gc=Object.prototype.hasOwnProperty;var P=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Bt=(t,e)=>{for(var r in e)gn(t,r,{get:e[r],enumerable:!0})},ma=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of zc(e))!Gc.call(t,i)&&i!==r&&gn(t,i,{get:()=>e[i],enumerable:!(n=qc(e,i))||n.enumerable});return t};var X=(t,e,r)=>(r=t!=null?Vc(Hc(t)):{},ma(e||!t||!t.__esModule?gn(r,"default",{value:t,enumerable:!0}):r,t)),Wc=t=>ma(gn({},"__esModule",{value:!0}),t);var Oa=P((T1,Ma)=>{"use strict";Ma.exports=Ju;function Ju(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,f){r[n]=function(u){if(s)if(s=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{t.apply(e||null,r)}catch(c){s&&(s=!1,f(c))}})}});var za=P(qa=>{"use strict";var bn=qa;bn.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var fr=new Array(64),Va=new Array(123);for(Ht=0;Ht<64;)Va[fr[Ht]=Ht<26?Ht+65:Ht<52?Ht+71:Ht<62?Ht-4:Ht-59|43]=Ht++;var Ht;bn.encode=function(e,r,n){for(var i=null,s=[],a=0,o=0,f;r<n;){var c=e[r++];switch(o){case 0:s[a++]=fr[c>>2],f=(c&3)<<4,o=1;break;case 1:s[a++]=fr[f|c>>4],f=(c&15)<<2,o=2;break;case 2:s[a++]=fr[f|c>>6],s[a++]=fr[c&63],o=0;break}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return o&&(s[a++]=fr[f],s[a++]=61,o===1&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var Fa="invalid encoding";bn.decode=function(e,r,n){for(var i=n,s=0,a,o=0;o<e.length;){var f=e.charCodeAt(o++);if(f===61&&s>1)break;if((f=Va[f])===void 0)throw Error(Fa);switch(s){case 0:a=f,s=1;break;case 1:r[n++]=a<<2|(f&48)>>4,a=f,s=2;break;case 2:r[n++]=(a&15)<<4|(f&60)>>2,a=f,s=3;break;case 3:r[n++]=(a&3)<<6|f,s=0;break}}if(s===1)throw Error(Fa);return n-i};bn.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Ga=P((_1,Ha)=>{"use strict";Ha.exports=wn;function wn(){this._listeners={}}wn.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};wn.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};wn.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Ja=P((R1,Xa)=>{"use strict";Xa.exports=Wa(Wa);function Wa(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function s(f,c,u){e[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}t.writeFloatLE=n?i:s,t.writeFloatBE=n?s:i;function a(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],e[0]}function o(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],e[0]}t.readFloatLE=n?a:o,t.readFloatBE=n?o:a}():function(){function e(n,i,s,a){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,s,a);else if(isNaN(i))n(2143289344,s,a);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,s,a);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,s,a);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((o<<31|f+127<<23|c)>>>0,s,a)}}t.writeFloatLE=e.bind(null,$a),t.writeFloatBE=e.bind(null,Za);function r(n,i,s){var a=n(i,s),o=(a>>31)*2+1,f=a>>>23&255,c=a&8388607;return f===255?c?NaN:o*(1/0):f===0?o*1401298464324817e-60*c:o*Math.pow(2,f-150)*(c+8388608)}t.readFloatLE=r.bind(null,Ya),t.readFloatBE=r.bind(null,Qa)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function s(f,c,u){e[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}t.writeDoubleLE=n?i:s,t.writeDoubleBE=n?s:i;function a(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],e[0]}function o(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],e[0]}t.readDoubleLE=n?a:o,t.readDoubleBE=n?o:a}():function(){function e(n,i,s,a,o,f){var c=a<0?1:0;if(c&&(a=-a),a===0)n(0,o,f+i),n(1/a>0?0:2147483648,o,f+s);else if(isNaN(a))n(0,o,f+i),n(2146959360,o,f+s);else if(a>17976931348623157e292)n(0,o,f+i),n((c<<31|2146435072)>>>0,o,f+s);else{var u;if(a<22250738585072014e-324)u=a/5e-324,n(u>>>0,o,f+i),n((c<<31|u/4294967296)>>>0,o,f+s);else{var h=Math.floor(Math.log(a)/Math.LN2);h===1024&&(h=1023),u=a*Math.pow(2,-h),n(u*4503599627370496>>>0,o,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,o,f+s)}}}t.writeDoubleLE=e.bind(null,$a,0,4),t.writeDoubleBE=e.bind(null,Za,4,0);function r(n,i,s,a,o){var f=n(a,o+i),c=n(a,o+s),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,Ya,0,4),t.readDoubleBE=r.bind(null,Qa,4,0)}(),t}function $a(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Za(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function Ya(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Qa(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var ja=P((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var eo=P(to=>{"use strict";var Fi=to;Fi.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Fi.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var s=null,a=[],o=0,f;r<n;)f=e[r++],f<128?a[o++]=f:f>191&&f<224?a[o++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,a[o++]=55296+(f>>10),a[o++]=56320+(f&1023)):a[o++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};Fi.write=function(e,r,n){for(var i=n,s,a,o=0;o<e.length;++o)s=e.charCodeAt(o),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((a=e.charCodeAt(o+1))&64512)===56320?(s=65536+((s&1023)<<10)+(a&1023),++o,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var no=P((D1,ro)=>{"use strict";ro.exports=ju;function ju(t,e,r){var n=r||8192,i=n>>>1,s=null,a=n;return function(f){if(f<1||f>i)return t(f);a+f>n&&(s=t(n),a=0);var c=e.call(s,a,a+=f);return a&7&&(a=(a|7)+1),c}}});var so=P((L1,io)=>{"use strict";io.exports=xt;var Kr=Ce();function xt(t,e){this.lo=t>>>0,this.hi=e>>>0}var He=xt.zero=new xt(0,0);He.toNumber=function(){return 0};He.zzEncode=He.zzDecode=function(){return this};He.length=function(){return 1};var th=xt.zeroHash="\0\0\0\0\0\0\0\0";xt.fromNumber=function(e){if(e===0)return He;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new xt(n,i)};xt.from=function(e){if(typeof e=="number")return xt.fromNumber(e);if(Kr.isString(e))if(Kr.Long)e=Kr.Long.fromString(e);else return xt.fromNumber(parseInt(e,10));return e.low||e.high?new xt(e.low>>>0,e.high>>>0):He};xt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};xt.prototype.toLong=function(e){return Kr.Long?new Kr.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Ae=String.prototype.charCodeAt;xt.fromHash=function(e){return e===th?He:new xt((Ae.call(e,0)|Ae.call(e,1)<<8|Ae.call(e,2)<<16|Ae.call(e,3)<<24)>>>0,(Ae.call(e,4)|Ae.call(e,5)<<8|Ae.call(e,6)<<16|Ae.call(e,7)<<24)>>>0)};xt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};xt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};xt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};xt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Ce=P(Vi=>{"use strict";var N=Vi;N.asPromise=Oa();N.base64=za();N.EventEmitter=Ga();N.float=Ja();N.inquire=ja();N.utf8=eo();N.pool=no();N.LongBits=so();N.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);N.global=N.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Vi;N.emptyArray=Object.freeze?Object.freeze([]):[];N.emptyObject=Object.freeze?Object.freeze({}):{};N.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};N.isString=function(e){return typeof e=="string"||e instanceof String};N.isObject=function(e){return e&&typeof e=="object"};N.isset=N.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};N.Buffer=function(){try{var t=N.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();N._Buffer_from=null;N._Buffer_allocUnsafe=null;N.newBuffer=function(e){return typeof e=="number"?N.Buffer?N._Buffer_allocUnsafe(e):new N.Array(e):N.Buffer?N._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};N.Array=typeof Uint8Array<"u"?Uint8Array:Array;N.Long=N.global.dcodeIO&&N.global.dcodeIO.Long||N.global.Long||N.inquire("long");N.key2Re=/^true|false|0|1$/;N.key32Re=/^-?(?:0|[1-9][0-9]*)$/;N.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;N.longToHash=function(e){return e?N.LongBits.from(e).toHash():N.LongBits.zeroHash};N.longFromHash=function(e,r){var n=N.LongBits.fromHash(e);return N.Long?N.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function ao(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}N.merge=ao;N.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function oo(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&ao(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}N.newError=oo;N.ProtocolError=oo("ProtocolError");N.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};N.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};N.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};N._configure=function(){var t=N.Buffer;if(!t){N._Buffer_from=N._Buffer_allocUnsafe=null;return}N._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},N._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var En=P((P1,lo)=>{"use strict";lo.exports=lt;var jt=Ce(),zi,uo=jt.LongBits,eh=jt.utf8;function Gt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function lt(t){this.buf=t,this.pos=0,this.len=t.length}var fo=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new lt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new lt(e);throw Error("illegal buffer")},ho=function(){return jt.Buffer?function(r){return(lt.create=function(i){return jt.Buffer.isBuffer(i)?new zi(i):fo(i)})(r)}:fo};lt.create=ho();lt.prototype._slice=jt.Array.prototype.subarray||jt.Array.prototype.slice;lt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Gt(this,10);return e}}();lt.prototype.int32=function(){return this.uint32()|0};lt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function qi(){var t=new uo(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Gt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Gt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}lt.prototype.bool=function(){return this.uint32()!==0};function Sn(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}lt.prototype.fixed32=function(){if(this.pos+4>this.len)throw Gt(this,4);return Sn(this.buf,this.pos+=4)};lt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Gt(this,4);return Sn(this.buf,this.pos+=4)|0};function co(){if(this.pos+8>this.len)throw Gt(this,8);return new uo(Sn(this.buf,this.pos+=4),Sn(this.buf,this.pos+=4))}lt.prototype.float=function(){if(this.pos+4>this.len)throw Gt(this,4);var e=jt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};lt.prototype.double=function(){if(this.pos+8>this.len)throw Gt(this,4);var e=jt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};lt.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Gt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};lt.prototype.string=function(){var e=this.bytes();return eh.read(e,0,e.length)};lt.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Gt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Gt(this);while(this.buf[this.pos++]&128);return this};lt.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};lt._configure=function(t){zi=t,lt.create=ho(),zi._configure();var e=jt.Long?"toLong":"toNumber";jt.merge(lt.prototype,{int64:function(){return qi.call(this)[e](!1)},uint64:function(){return qi.call(this)[e](!0)},sint64:function(){return qi.call(this).zzDecode()[e](!1)},fixed64:function(){return co.call(this)[e](!0)},sfixed64:function(){return co.call(this)[e](!1)}})}});var Hi=P((U1,go)=>{"use strict";go.exports=Ge;var yo=En();(Ge.prototype=Object.create(yo.prototype)).constructor=Ge;var po=Ce();function Ge(t){yo.call(this,t)}Ge._configure=function(){po.Buffer&&(Ge.prototype._slice=po.Buffer.prototype.slice)};Ge.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Ge._configure()});var An=P((K1,bo)=>{"use strict";bo.exports=H;var Mt=Ce(),Gi,Bn=Mt.LongBits,mo=Mt.base64,xo=Mt.utf8;function Mr(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function $i(){}function rh(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function H(){this.len=0,this.head=new Mr($i,0,0),this.tail=this.head,this.states=null}var vo=function(){return Mt.Buffer?function(){return(H.create=function(){return new Gi})()}:function(){return new H}};H.create=vo();H.alloc=function(e){return new Mt.Array(e)};Mt.Array!==Array&&(H.alloc=Mt.pool(H.alloc,Mt.Array.prototype.subarray));H.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Mr(e,r,n),this.len+=r,this};function Zi(t,e,r){e[r]=t&255}function nh(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Yi(t,e){this.len=t,this.next=void 0,this.val=e}Yi.prototype=Object.create(Mr.prototype);Yi.prototype.fn=nh;H.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Yi((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};H.prototype.int32=function(e){return e<0?this._push(Qi,10,Bn.fromNumber(e)):this.uint32(e)};H.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Qi(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}H.prototype.uint64=function(e){var r=Bn.from(e);return this._push(Qi,r.length(),r)};H.prototype.int64=H.prototype.uint64;H.prototype.sint64=function(e){var r=Bn.from(e).zzEncode();return this._push(Qi,r.length(),r)};H.prototype.bool=function(e){return this._push(Zi,1,e?1:0)};function Wi(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}H.prototype.fixed32=function(e){return this._push(Wi,4,e>>>0)};H.prototype.sfixed32=H.prototype.fixed32;H.prototype.fixed64=function(e){var r=Bn.from(e);return this._push(Wi,4,r.lo)._push(Wi,4,r.hi)};H.prototype.sfixed64=H.prototype.fixed64;H.prototype.float=function(e){return this._push(Mt.float.writeFloatLE,4,e)};H.prototype.double=function(e){return this._push(Mt.float.writeDoubleLE,8,e)};var ih=Mt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};H.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Zi,1,0);if(Mt.isString(e)){var n=H.alloc(r=mo.length(e));mo.decode(e,n,0),e=n}return this.uint32(r)._push(ih,r,e)};H.prototype.string=function(e){var r=xo.length(e);return r?this.uint32(r)._push(xo.write,r,e):this._push(Zi,1,0)};H.prototype.fork=function(){return this.states=new rh(this),this.head=this.tail=new Mr($i,0,0),this.len=0,this};H.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Mr($i,0,0),this.len=0),this};H.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};H.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};H._configure=function(t){Gi=t,H.create=vo(),Gi._configure()}});var Xi=P((M1,So)=>{"use strict";So.exports=te;var wo=An();(te.prototype=Object.create(wo.prototype)).constructor=te;var Te=Ce();function te(){wo.call(this)}te._configure=function(){te.alloc=Te._Buffer_allocUnsafe,te.writeBytesBuffer=Te.Buffer&&Te.Buffer.prototype instanceof Uint8Array&&Te.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};te.prototype.bytes=function(e){Te.isString(e)&&(e=Te._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(te.writeBytesBuffer,r,e),this};function sh(t,e,r){t.length<40?Te.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}te.prototype.string=function(e){var r=Te.Buffer.byteLength(e);return this.uint32(r),r&&this._push(sh,r,e),this};te._configure()});var J=P((r2,To)=>{To.exports={options:{usePureJavaScript:!1}}});var Ro=P((n2,_o)=>{var is={};_o.exports=is;var Io={};is.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=ch(t,e);else{var i=0,s=e.length,a=e.charAt(0),o=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<o.length;++f)c+=o[f]<<8,o[f]=c%s,c=c/s|0;for(;c>0;)o.push(c%s),c=c/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=a;for(i=o.length-1;i>=0;--i)n+=e[o[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};is.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Io[e];if(!r){r=Io[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),a=[0],n=0;n<t.length;n++){var o=r[t.charCodeAt(n)];if(o===void 0)return;for(var f=0,c=o;f<a.length;++f)c+=a[f]*i,a[f]=c&255,c>>=8;for(;c>0;)a.push(c&255),c>>=8}for(var u=0;t[u]===s&&u<t.length-1;++u)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function ch(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var a=0,o=t.at(r);a<s.length;++a)o+=s[a]<<8,s[a]=o%n,o=o/n|0;for(;o>0;)s.push(o%n),o=o/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=s.length-1;r>=0;--r)f+=e[s[r]];return f}});var dt=P((i2,ko)=>{var No=J(),Do=Ro(),y=ko.exports=No.util=No.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){y.nextTick=process.nextTick,typeof setImmediate=="function"?y.setImmediate=setImmediate:y.setImmediate=y.nextTick;return}if(typeof setImmediate=="function"){y.setImmediate=function(){return setImmediate.apply(void 0,arguments)},y.nextTick=function(o){return setImmediate(o)};return}if(y.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var a=o,t="forge.setImmediate",e=[];y.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var s=y.setImmediate;y.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),s(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}y.nextTick=y.setImmediate})();y.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;y.globalScope=function(){return y.isNodejs?globalThis:typeof self>"u"?window:self}();y.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};y.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};y.isArrayBufferView=function(t){return t&&y.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Or(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}y.ByteBuffer=ss;function ss(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(y.isArrayBuffer(t)||y.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof ss||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}y.ByteStringBuffer=ss;var uh=4096;y.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>uh&&(this.data.substr(0,1),this._constructedStringLength=0)};y.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};y.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};y.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};y.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};y.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};y.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(y.encodeUtf8(t))};y.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};y.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};y.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};y.ByteStringBuffer.prototype.putInt=function(t,e){Or(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};y.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};y.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};y.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};y.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};y.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};y.ByteStringBuffer.prototype.getInt=function(t){Or(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};y.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};y.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};y.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};y.ByteStringBuffer.prototype.copy=function(){var t=y.createBuffer(this.data);return t.read=this.read,t};y.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};y.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};y.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};y.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.ByteStringBuffer.prototype.toString=function(){return y.decodeUtf8(this.bytes())};function hh(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=y.isArrayBuffer(t),n=y.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}y.DataBuffer=hh;y.DataBuffer.prototype.length=function(){return this.write-this.read};y.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};y.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};y.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};y.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};y.DataBuffer.prototype.putBytes=function(t,e){if(y.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(y.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof y.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&y.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof y.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=y.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=y.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};y.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};y.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};y.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};y.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};y.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};y.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};y.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};y.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};y.DataBuffer.prototype.putInt=function(t,e){Or(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};y.DataBuffer.prototype.putSignedInt=function(t,e){return Or(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};y.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};y.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};y.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};y.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};y.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};y.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};y.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};y.DataBuffer.prototype.getInt=function(t){Or(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};y.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};y.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};y.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};y.DataBuffer.prototype.copy=function(){return new y.DataBuffer(this)};y.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};y.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};y.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};y.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return y.binary.raw.encode(e);if(t==="hex")return y.binary.hex.encode(e);if(t==="base64")return y.binary.base64.encode(e);if(t==="utf8")return y.text.utf8.decode(e);if(t==="utf16")return y.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};y.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=y.encodeUtf8(t)),new y.ByteBuffer(t)};y.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};y.xorBytes=function(t,e,r){for(var n="",i="",s="",a=0,o=0;r>0;--r,++a)i=t.charCodeAt(a)^e.charCodeAt(a),o>=10&&(n+=s,s="",o=0),s+=String.fromCharCode(i),++o;return n+=s,n};y.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};y.bytesToHex=function(t){return y.createBuffer(t).toHex()};y.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_e=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Lo="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";y.encode64=function(t,e){for(var r="",n="",i,s,a,o=0;o<t.length;)i=t.charCodeAt(o++),s=t.charCodeAt(o++),a=t.charCodeAt(o++),r+=Ie.charAt(i>>2),r+=Ie.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Ie.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Ie.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,a=0;a<t.length;)r=_e[t.charCodeAt(a++)-43],n=_e[t.charCodeAt(a++)-43],i=_e[t.charCodeAt(a++)-43],s=_e[t.charCodeAt(a++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};y.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};y.decodeUtf8=function(t){return decodeURIComponent(escape(t))};y.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Do.encode,decode:Do.decode}};y.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};y.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};y.binary.hex.encode=y.bytesToHex;y.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};y.binary.base64.encode=function(t,e){for(var r="",n="",i,s,a,o=0;o<t.byteLength;)i=t[o++],s=t[o++],a=t[o++],r+=Ie.charAt(i>>2),r+=Ie.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Ie.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Ie.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,a,o,f=0,c=r;f<t.length;)i=_e[t.charCodeAt(f++)-43],s=_e[t.charCodeAt(f++)-43],a=_e[t.charCodeAt(f++)-43],o=_e[t.charCodeAt(f++)-43],n[c++]=i<<2|s>>4,a!==64&&(n[c++]=(s&15)<<4|a>>2,o!==64&&(n[c++]=(a&3)<<6|o));return e?c-r:n.subarray(0,c)};y.binary.base58.encode=function(t,e){return y.binary.baseN.encode(t,Lo,e)};y.binary.base58.decode=function(t,e){return y.binary.baseN.decode(t,Lo,e)};y.text={utf8:{},utf16:{}};y.text.utf8.encode=function(t,e,r){t=y.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};y.text.utf8.decode=function(t){return y.decodeUtf8(String.fromCharCode.apply(null,t))};y.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,a=r,o=0;o<t.length;++o)i[a++]=t.charCodeAt(o),s+=2;return e?s-r:n};y.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};y.deflate=function(t,e,r){if(e=y.decode64(t.deflate(y.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};y.inflate=function(t,e,r){var n=t.inflate(y.encode64(e)).rval;return n===null?null:y.decode64(n)};var as=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=y.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},os=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(y.decode64(r))),r},lh=function(t,e,r,n){var i=os(t,e);i===null&&(i={}),i[r]=n,as(t,e,i)},ph=function(t,e,r){var n=os(t,e);return n!==null&&(n=r in n?n[r]:null),n},dh=function(t,e,r){var n=os(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),as(t,e,n)}},yh=function(t,e){as(t,e,null)},Nn=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,a=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(f){a=f}if(s)break}if(!s)throw a;return n};y.setItem=function(t,e,r,n,i){Nn(lh,arguments,i)};y.getItem=function(t,e,r,n){return Nn(ph,arguments,n)};y.removeItem=function(t,e,r,n){Nn(dh,arguments,n)};y.clearItems=function(t,e,r){Nn(yh,arguments,r)};y.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};y.format=function(t){for(var e=/%./g,r,n,i=0,s=[],a=0;r=e.exec(t);){n=t.substring(a,e.lastIndex-2),n.length>0&&s.push(n),a=e.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+o+"?>")}}return s.push(t.substring(a)),s.join("")};y.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,a=r===void 0?",":r,o=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+o:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(s?a+Math.abs(i-c).toFixed(s).slice(2):"")};y.formatSize=function(t){return t>=1073741824?t=y.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=y.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=y.formatNumber(t/1024,0)+" KiB":t=y.formatNumber(t,0)+" bytes",t};y.bytesFromIP=function(t){return t.indexOf(".")!==-1?y.bytesFromIPv4(t):t.indexOf(":")!==-1?y.bytesFromIPv6(t):null};y.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=y.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};y.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(a){return a.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=y.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=y.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};y.bytesToIP=function(t){return t.length===4?y.bytesToIPv4(t):t.length===16?y.bytesToIPv6(t):null};y.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};y.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=y.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],o=e.length;!a||o!==a.end+1?r.push({start:o,end:o}):(a.end=o,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};y.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in y&&!t.update)return e(null,y.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return y.cores=navigator.hardwareConcurrency,e(null,y.cores);if(typeof Worker>"u")return y.cores=1,e(null,y.cores);if(typeof Blob>"u")return y.cores=2,e(null,y.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var o=Date.now(),f=o+4;Date.now()<f;);self.postMessage({st:o,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(a,o,f){if(o===0){var c=Math.floor(a.reduce(function(u,h){return u+h},0)/a.length);return y.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,y.cores)}i(f,function(u,h){a.push(s(f,h)),n(a,o-1,f)})}function i(a,o){for(var f=[],c=[],u=0;u<a;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===a){for(var d=0;d<a;++d)f[d].terminate();o(null,c)}}),f.push(h)}for(var u=0;u<a;++u)f[u].postMessage(u)}function s(a,o){for(var f=[],c=0;c<a;++c)for(var u=o[c],h=f[c]=[],l=0;l<a;++l)if(c!==l){var d=o[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return f.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var Dn=P((s2,Po)=>{var Fr=J();Fr.pki=Fr.pki||{};var fs=Po.exports=Fr.pki.oids=Fr.oids=Fr.oids||{};function E(t,e){fs[t]=e,fs[e]=t}function Q(t,e){fs[t]=e}E("1.2.840.113549.1.1.1","rsaEncryption");E("1.2.840.113549.1.1.4","md5WithRSAEncryption");E("1.2.840.113549.1.1.5","sha1WithRSAEncryption");E("1.2.840.113549.1.1.7","RSAES-OAEP");E("1.2.840.113549.1.1.8","mgf1");E("1.2.840.113549.1.1.9","pSpecified");E("1.2.840.113549.1.1.10","RSASSA-PSS");E("1.2.840.113549.1.1.11","sha256WithRSAEncryption");E("1.2.840.113549.1.1.12","sha384WithRSAEncryption");E("1.2.840.113549.1.1.13","sha512WithRSAEncryption");E("1.3.101.112","EdDSA25519");E("1.2.840.10040.4.3","dsa-with-sha1");E("1.3.14.3.2.7","desCBC");E("1.3.14.3.2.26","sha1");E("1.3.14.3.2.29","sha1WithRSASignature");E("2.16.840.1.101.3.4.2.1","sha256");E("2.16.840.1.101.3.4.2.2","sha384");E("2.16.840.1.101.3.4.2.3","sha512");E("2.16.840.1.101.3.4.2.4","sha224");E("2.16.840.1.101.3.4.2.5","sha512-224");E("2.16.840.1.101.3.4.2.6","sha512-256");E("1.2.840.113549.2.2","md2");E("1.2.840.113549.2.5","md5");E("1.2.840.113549.1.7.1","data");E("1.2.840.113549.1.7.2","signedData");E("1.2.840.113549.1.7.3","envelopedData");E("1.2.840.113549.1.7.4","signedAndEnvelopedData");E("1.2.840.113549.1.7.5","digestedData");E("1.2.840.113549.1.7.6","encryptedData");E("1.2.840.113549.1.9.1","emailAddress");E("1.2.840.113549.1.9.2","unstructuredName");E("1.2.840.113549.1.9.3","contentType");E("1.2.840.113549.1.9.4","messageDigest");E("1.2.840.113549.1.9.5","signingTime");E("1.2.840.113549.1.9.6","counterSignature");E("1.2.840.113549.1.9.7","challengePassword");E("1.2.840.113549.1.9.8","unstructuredAddress");E("1.2.840.113549.1.9.14","extensionRequest");E("1.2.840.113549.1.9.20","friendlyName");E("1.2.840.113549.1.9.21","localKeyId");E("1.2.840.113549.1.9.22.1","x509Certificate");E("1.2.840.113549.1.12.10.1.1","keyBag");E("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");E("1.2.840.113549.1.12.10.1.3","certBag");E("1.2.840.113549.1.12.10.1.4","crlBag");E("1.2.840.113549.1.12.10.1.5","secretBag");E("1.2.840.113549.1.12.10.1.6","safeContentsBag");E("1.2.840.113549.1.5.13","pkcs5PBES2");E("1.2.840.113549.1.5.12","pkcs5PBKDF2");E("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");E("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");E("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");E("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");E("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");E("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");E("1.2.840.113549.2.7","hmacWithSHA1");E("1.2.840.113549.2.8","hmacWithSHA224");E("1.2.840.113549.2.9","hmacWithSHA256");E("1.2.840.113549.2.10","hmacWithSHA384");E("1.2.840.113549.2.11","hmacWithSHA512");E("1.2.840.113549.3.7","des-EDE3-CBC");E("2.16.840.1.101.3.4.1.2","aes128-CBC");E("2.16.840.1.101.3.4.1.22","aes192-CBC");E("2.16.840.1.101.3.4.1.42","aes256-CBC");E("2.5.4.3","commonName");E("2.5.4.4","surname");E("2.5.4.5","serialNumber");E("2.5.4.6","countryName");E("2.5.4.7","localityName");E("2.5.4.8","stateOrProvinceName");E("2.5.4.9","streetAddress");E("2.5.4.10","organizationName");E("2.5.4.11","organizationalUnitName");E("2.5.4.12","title");E("2.5.4.13","description");E("2.5.4.15","businessCategory");E("2.5.4.17","postalCode");E("2.5.4.42","givenName");E("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");E("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");E("2.16.840.1.113730.1.1","nsCertType");E("2.16.840.1.113730.1.13","nsComment");Q("2.5.29.1","authorityKeyIdentifier");Q("2.5.29.2","keyAttributes");Q("2.5.29.3","certificatePolicies");Q("2.5.29.4","keyUsageRestriction");Q("2.5.29.5","policyMapping");Q("2.5.29.6","subtreesConstraint");Q("2.5.29.7","subjectAltName");Q("2.5.29.8","issuerAltName");Q("2.5.29.9","subjectDirectoryAttributes");Q("2.5.29.10","basicConstraints");Q("2.5.29.11","nameConstraints");Q("2.5.29.12","policyConstraints");Q("2.5.29.13","basicConstraints");E("2.5.29.14","subjectKeyIdentifier");E("2.5.29.15","keyUsage");Q("2.5.29.16","privateKeyUsagePeriod");E("2.5.29.17","subjectAltName");E("2.5.29.18","issuerAltName");E("2.5.29.19","basicConstraints");Q("2.5.29.20","cRLNumber");Q("2.5.29.21","cRLReason");Q("2.5.29.22","expirationDate");Q("2.5.29.23","instructionCode");Q("2.5.29.24","invalidityDate");Q("2.5.29.25","cRLDistributionPoints");Q("2.5.29.26","issuingDistributionPoint");Q("2.5.29.27","deltaCRLIndicator");Q("2.5.29.28","issuingDistributionPoint");Q("2.5.29.29","certificateIssuer");Q("2.5.29.30","nameConstraints");E("2.5.29.31","cRLDistributionPoints");E("2.5.29.32","certificatePolicies");Q("2.5.29.33","policyMappings");Q("2.5.29.34","policyConstraints");E("2.5.29.35","authorityKeyIdentifier");Q("2.5.29.36","policyConstraints");E("2.5.29.37","extKeyUsage");Q("2.5.29.46","freshestCRL");Q("2.5.29.54","inhibitAnyPolicy");E("1.3.6.1.4.1.11129.2.4.2","timestampList");E("1.3.6.1.5.5.7.1.1","authorityInfoAccess");E("1.3.6.1.5.5.7.3.1","serverAuth");E("1.3.6.1.5.5.7.3.2","clientAuth");E("1.3.6.1.5.5.7.3.3","codeSigning");E("1.3.6.1.5.5.7.3.4","emailProtection");E("1.3.6.1.5.5.7.3.8","timeStamping")});var qr=P((a2,Ko)=>{var rt=J();dt();Dn();var C=Ko.exports=rt.asn1=rt.asn1||{};C.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};C.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};C.create=function(t,e,r,n,i){if(rt.util.isArray(n)){for(var s=[],a=0;a<n.length;++a)n[a]!==void 0&&s.push(n[a]);n=s}var o={tagClass:t,type:e,constructed:r,composed:r||rt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=C.copy(o)),o};C.copy=function(t,e){var r;if(rt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(C.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:C.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};C.equals=function(t,e,r){if(rt.util.isArray(t)){if(!rt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!C.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&C.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};C.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Vr(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var gh=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;Vr(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};C.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=rt.util.createBuffer(t));var r=t.length(),n=Ln(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function Ln(t,e,r,n){var i;Vr(t,e,2);var s=t.getByte();e--;var a=s&192,o=s&31;i=t.length();var f=gh(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,h,l=(s&32)===32;if(l)if(u=[],f===void 0)for(;;){if(Vr(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(Ln(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(Ln(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&a===C.Class.UNIVERSAL&&o===C.Type.BITSTRING&&(h=t.bytes(f)),u===void 0&&n.decodeBitStrings&&a===C.Class.UNIVERSAL&&o===C.Type.BITSTRING&&f>1){var d=t.read,p=e,g=0;if(o===C.Type.BITSTRING&&(Vr(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var x={strict:!0,decodeBitStrings:!0},v=Ln(t,e,r+1,x),B=i-t.length();e-=B,o==C.Type.BITSTRING&&B++;var A=v.tagClass;B===f&&(A===C.Class.UNIVERSAL||A===C.Class.CONTEXT_SPECIFIC)&&(u=[v])}catch{}u===void 0&&(t.read=d,e=p)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(o===C.Type.BMPSTRING)for(u="";f>0;f-=2)Vr(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var L=h===void 0?null:{bitStringContents:h};return C.create(a,o,l,u,L)}C.toDer=function(t){var e=rt.util.createBuffer(),r=t.tagClass|t.type,n=rt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=C.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(C.toDer(t.value[s]))}else if(t.type===C.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===C.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var a=n.length(),o="";do o+=String.fromCharCode(a&255),a=a>>>8;while(a>0);e.putByte(o.length|128);for(var s=o.length-1;s>=0;--s)e.putByte(o.charCodeAt(s))}return e.putBuffer(n),e};C.oidToDer=function(t){var e=t.split("."),r=rt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,a,o=2;o<e.length;++o){n=!0,i=[],s=parseInt(e[o],10);do a=s&127,s=s>>>7,n||(a|=128),i.push(a),n=!1;while(s>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};C.derToOid=function(t){var e;typeof t=="string"&&(t=rt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};C.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(o=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,a,o,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};C.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);c=d*60+p,c*=6e4,l==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,a,o,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(s,a,o,f)),e};C.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};C.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};C.integerToDer=function(t){var e=rt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};C.derToInteger=function(t){typeof t=="string"&&(t=rt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};C.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&rt.util.isArray(e.value))for(var s=0,a=0;i&&a<e.value.length;++a)i=e.value[a].optional||!1,t.value[s]&&(i=C.validate(t.value[s],e.value[a],r,n),i?++s:e.value[a].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var o;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Uo=/[^\\u0000-\\u00ff]/;C.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case C.Class.UNIVERSAL:n+="Universal:";break;case C.Class.APPLICATION:n+="Application:";break;case C.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case C.Class.PRIVATE:n+="Private:";break}if(t.tagClass===C.Class.UNIVERSAL)switch(n+=t.type,t.type){case C.Type.NONE:n+=" (None)";break;case C.Type.BOOLEAN:n+=" (Boolean)";break;case C.Type.INTEGER:n+=" (Integer)";break;case C.Type.BITSTRING:n+=" (Bit string)";break;case C.Type.OCTETSTRING:n+=" (Octet string)";break;case C.Type.NULL:n+=" (Null)";break;case C.Type.OID:n+=" (Object Identifier)";break;case C.Type.ODESC:n+=" (Object Descriptor)";break;case C.Type.EXTERNAL:n+=" (External or Instance of)";break;case C.Type.REAL:n+=" (Real)";break;case C.Type.ENUMERATED:n+=" (Enumerated)";break;case C.Type.EMBEDDED:n+=" (Embedded PDV)";break;case C.Type.UTF8:n+=" (UTF8)";break;case C.Type.ROID:n+=" (Relative Object Identifier)";break;case C.Type.SEQUENCE:n+=" (Sequence)";break;case C.Type.SET:n+=" (Set)";break;case C.Type.PRINTABLESTRING:n+=" (Printable String)";break;case C.Type.IA5String:n+=" (IA5String (ASCII))";break;case C.Type.UTCTIME:n+=" (UTC time)";break;case C.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case C.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var a=0,o="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(a+=1,o+=C.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(o+=","));n+=i+"Sub values: "+a+o}else{if(n+=i+"Value: ",t.type===C.Type.OID){var f=C.derToOid(t.value);n+=f,rt.pki&&rt.pki.oids&&f in rt.pki.oids&&(n+=" ("+rt.pki.oids[f]+") ")}if(t.type===C.Type.INTEGER)try{n+=C.derToInteger(t.value)}catch{n+="0x"+rt.util.bytesToHex(t.value)}else if(t.type===C.Type.BITSTRING){if(t.value.length>1?n+="0x"+rt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===C.Type.OCTETSTRING)Uo.test(t.value)||(n+="("+t.value+") "),n+="0x"+rt.util.bytesToHex(t.value);else if(t.type===C.Type.UTF8)try{n+=rt.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+rt.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===C.Type.PRINTABLESTRING||t.type===C.Type.IA5String?n+=t.value:Uo.test(t.value)?n+="0x"+rt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var us=P((o2,Mo)=>{var vt=J();dt();Mo.exports=vt.cipher=vt.cipher||{};vt.cipher.algorithms=vt.cipher.algorithms||{};vt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=vt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new vt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};vt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=vt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new vt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};vt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),vt.cipher.algorithms[t]=e};vt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in vt.cipher.algorithms?vt.cipher.algorithms[t]:null};var cs=vt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};cs.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=vt.util.createBuffer(),this.output=t.output||vt.util.createBuffer(),this.mode.start(e)};cs.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};cs.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var ls=P((f2,Oo)=>{var bt=J();dt();bt.cipher=bt.cipher||{};var M=Oo.exports=bt.cipher.modes=bt.cipher.modes||{};M.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};M.ecb.prototype.start=function(t){};M.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};M.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};M.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};M.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};M.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};M.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=kn(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};M.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};M.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};M.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};M.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};M.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=bt.util.createBuffer(),this._partialBytes=0};M.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=kn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};M.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};M.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};M.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=bt.util.createBuffer(),this._partialBytes=0};M.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=kn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};M.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};M.ofb.prototype.decrypt=M.ofb.prototype.encrypt;M.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=bt.util.createBuffer(),this._partialBytes=0};M.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=kn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};M.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Pn(this._inBlock)};M.ctr.prototype.decrypt=M.ctr.prototype.encrypt;M.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=bt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};M.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=bt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=bt.util.createBuffer(t.additionalData):r=bt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=bt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(hs(n*8)))}this._inBlock=this._j0.slice(0),Pn(this._inBlock),this._partialBytes=0,r=bt.util.createBuffer(r),this._aDataLength=hs(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};M.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Pn(this._inBlock)};M.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Pn(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};M.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=bt.util.createBuffer();var n=this._aDataLength.concat(hs(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};M.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};M.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};M.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};M.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};M.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),a=0;a<i;++a){var o=[0,0,0,0],f=a/n|0,c=(n-1-a%n)*e;o[f]=1<<e-1<<c,s[a]=this.generateSubHashTable(this.multiply(o,t),e)}return s};M.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var a=1;a<s;++a){var o=i[s],f=i[a];i[s+a]=[o[0]^f[0],o[1]^f[1],o[2]^f[2],o[3]^f[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var c=i[s^n];i[s]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function kn(t,e){if(typeof t=="string"&&(t=bt.util.createBuffer(t)),bt.util.isArray(t)&&t.length>4){var r=t;t=bt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!bt.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}function Pn(t){t[t.length-1]=t[t.length-1]+1&4294967295}function hs(t){return[t/4294967296|0,t&4294967295]}});var gs=P((c2,zo)=>{var et=J();us();ls();dt();zo.exports=et.aes=et.aes||{};et.aes.startEncrypting=function(t,e,r,n){var i=Un({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};et.aes.createEncryptionCipher=function(t,e){return Un({key:t,output:null,decrypt:!1,mode:e})};et.aes.startDecrypting=function(t,e,r,n){var i=Un({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};et.aes.createDecryptionCipher=function(t,e){return Un({key:t,output:null,decrypt:!0,mode:e})};et.aes.Algorithm=function(t,e){ys||Vo();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return ds(r._w,n,i,!1)},decrypt:function(n,i){return ds(r._w,n,i,!0)}}}),r._init=!1};et.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=et.util.createBuffer(e);else if(et.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=et.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!et.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!et.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=qo(e,t.decrypt&&!a),this._init=!0}};et.aes._expandKey=function(t,e){return ys||Vo(),qo(t,e)};et.aes._updateBlock=ds;hr("AES-ECB",et.cipher.modes.ecb);hr("AES-CBC",et.cipher.modes.cbc);hr("AES-CFB",et.cipher.modes.cfb);hr("AES-OFB",et.cipher.modes.ofb);hr("AES-CTR",et.cipher.modes.ctr);hr("AES-GCM",et.cipher.modes.gcm);function hr(t,e){var r=function(){return new et.aes.Algorithm(t,e)};et.cipher.registerAlgorithm(t,r)}var ys=!1,ur=4,It,ps,Fo,We,Wt;function Vo(){ys=!0,Fo=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;It=new Array(256),ps=new Array(256),We=new Array(4),Wt=new Array(4);for(var e=0;e<4;++e)We[e]=new Array(256),Wt[e]=new Array(256);for(var r=0,n=0,i,s,a,o,f,c,u,e=0;e<256;++e){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,It[r]=o,ps[o]=r,f=t[o],i=t[r],s=t[i],a=t[s],c=f<<24^o<<16^o<<8^(o^f),u=(i^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^i^a);for(var h=0;h<4;++h)We[h][r]=c,Wt[h][o]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^a]]],n^=t[t[n]])}}function qo(t,e){for(var r=t.slice(0),n,i=1,s=r.length,a=s+6+1,o=ur*a,f=s;f<o;++f)n=r[f-1],f%s===0?(n=It[n>>>16&255]<<24^It[n>>>8&255]<<16^It[n&255]<<8^It[n>>>24]^Fo[i]<<24,i++):s>6&&f%s===4&&(n=It[n>>>24]<<24^It[n>>>16&255]<<16^It[n>>>8&255]<<8^It[n&255]),r[f]=r[f-s]^n;if(e){var c,u=Wt[0],h=Wt[1],l=Wt[2],d=Wt[3],p=r.slice(0);o=r.length;for(var f=0,g=o-ur;f<o;f+=ur,g-=ur)if(f===0||f===o-ur)p[f]=r[g],p[f+1]=r[g+3],p[f+2]=r[g+2],p[f+3]=r[g+1];else for(var x=0;x<ur;++x)c=r[g+x],p[f+(3&-x)]=u[It[c>>>24]]^h[It[c>>>16&255]]^l[It[c>>>8&255]]^d[It[c&255]];r=p}return r}function ds(t,e,r,n){var i=t.length/4-1,s,a,o,f,c;n?(s=Wt[0],a=Wt[1],o=Wt[2],f=Wt[3],c=ps):(s=We[0],a=We[1],o=We[2],f=We[3],c=It);var u,h,l,d,p,g,x;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var v=3,B=1;B<i;++B)p=s[u>>>24]^a[h>>>16&255]^o[l>>>8&255]^f[d&255]^t[++v],g=s[h>>>24]^a[l>>>16&255]^o[d>>>8&255]^f[u&255]^t[++v],x=s[l>>>24]^a[d>>>16&255]^o[u>>>8&255]^f[h&255]^t[++v],d=s[d>>>24]^a[u>>>16&255]^o[h>>>8&255]^f[l&255]^t[++v],u=p,h=g,l=x;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[d&255]^t[++v],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[d>>>8&255]<<8^c[u&255]^t[++v],r[2]=c[l>>>24]<<24^c[d>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^t[++v],r[n?1:3]=c[d>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^t[++v]}function Un(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=et.cipher.createDecipher(r,t.key):n=et.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof et.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var Wo=P((u2,Go)=>{var ot=J();us();ls();dt();Go.exports=ot.des=ot.des||{};ot.des.startEncrypting=function(t,e,r,n){var i=Kn({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};ot.des.createEncryptionCipher=function(t,e){return Kn({key:t,output:null,decrypt:!1,mode:e})};ot.des.startDecrypting=function(t,e,r,n){var i=Kn({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};ot.des.createDecryptionCipher=function(t,e){return Kn({key:t,output:null,decrypt:!0,mode:e})};ot.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Ho(r._keys,n,i,!1)},decrypt:function(n,i){return Ho(r._keys,n,i,!0)}}}),r._init=!1};ot.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=ot.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Ah(e),this._init=!0}};ne("DES-ECB",ot.cipher.modes.ecb);ne("DES-CBC",ot.cipher.modes.cbc);ne("DES-CFB",ot.cipher.modes.cfb);ne("DES-OFB",ot.cipher.modes.ofb);ne("DES-CTR",ot.cipher.modes.ctr);ne("3DES-ECB",ot.cipher.modes.ecb);ne("3DES-CBC",ot.cipher.modes.cbc);ne("3DES-CFB",ot.cipher.modes.cfb);ne("3DES-OFB",ot.cipher.modes.ofb);ne("3DES-CTR",ot.cipher.modes.ctr);function ne(t,e){var r=function(){return new ot.des.Algorithm(t,e)};ot.cipher.registerAlgorithm(t,r)}var mh=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],xh=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],vh=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],bh=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],wh=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Sh=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Eh=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Bh=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Ah(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,x=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],B=0,A,L=0;L<g;L++){var T=t.getInt32(),_=t.getInt32();A=(T>>>4^_)&252645135,_^=A,T^=A<<4,A=(_>>>-16^T)&65535,T^=A,_^=A<<-16,A=(T>>>2^_)&858993459,_^=A,T^=A<<2,A=(_>>>-16^T)&65535,T^=A,_^=A<<-16,A=(T>>>1^_)&1431655765,_^=A,T^=A<<1,A=(_>>>8^T)&16711935,T^=A,_^=A<<8,A=(T>>>1^_)&1431655765,_^=A,T^=A<<1,A=T<<8|_>>>20&240,T=_<<24|_<<8&16711680|_>>>8&65280|_>>>24&240,_=A;for(var F=0;F<v.length;++F){v[F]?(T=T<<2|T>>>26,_=_<<2|_>>>26):(T=T<<1|T>>>27,_=_<<1|_>>>27),T&=-15,_&=-15;var $=e[T>>>28]|r[T>>>24&15]|n[T>>>20&15]|i[T>>>16&15]|s[T>>>12&15]|a[T>>>8&15]|o[T>>>4&15],Et=f[_>>>28]|c[_>>>24&15]|u[_>>>20&15]|h[_>>>16&15]|l[_>>>12&15]|d[_>>>8&15]|p[_>>>4&15];A=(Et>>>16^$)&65535,x[B++]=$^A,x[B++]=Et^A<<16}}return x}function Ho(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,o=e[0],f=e[1];a=(o>>>4^f)&252645135,f^=a,o^=a<<4,a=(o>>>16^f)&65535,f^=a,o^=a<<16,a=(f>>>2^o)&858993459,o^=a,f^=a<<2,a=(f>>>8^o)&16711935,o^=a,f^=a<<8,a=(o>>>1^f)&1431655765,f^=a,o^=a<<1,o=o<<1|o>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=s[c+1],h=s[c+2],l=s[c];l!=u;l+=h){var d=f^t[l],p=(f>>>4|f<<28)^t[l+1];a=o,o=f,f=a^(xh[d>>>24&63]|bh[d>>>16&63]|Sh[d>>>8&63]|Bh[d&63]|mh[p>>>24&63]|vh[p>>>16&63]|wh[p>>>8&63]|Eh[p&63])}a=o,o=f,f=a}o=o>>>1|o<<31,f=f>>>1|f<<31,a=(o>>>1^f)&1431655765,f^=a,o^=a<<1,a=(f>>>8^o)&16711935,o^=a,f^=a<<8,a=(f>>>2^o)&858993459,o^=a,f^=a<<2,a=(o>>>16^f)&65535,f^=a,o^=a<<16,a=(o>>>4^f)&252645135,f^=a,o^=a<<4,r[0]=o,r[1]=f}function Kn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=ot.cipher.createDecipher(r,t.key):n=ot.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof ot.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var $e=P((h2,$o)=>{var Mn=J();$o.exports=Mn.md=Mn.md||{};Mn.md.algorithms=Mn.md.algorithms||{}});var Yo=P((l2,Zo)=>{var ge=J();$e();dt();var Ch=Zo.exports=ge.hmac=ge.hmac||{};Ch.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in ge.md.algorithms)e=ge.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(a===null)a=t;else{if(typeof a=="string")a=ge.util.createBuffer(a);else if(ge.util.isArray(a)){var o=a;a=ge.util.createBuffer();for(var f=0;f<o.length;++f)a.putByte(o[f])}var c=a.length();c>e.blockLength&&(e.start(),e.update(a.bytes()),a=e.digest()),r=ge.util.createBuffer(),n=ge.util.createBuffer(),c=a.length();for(var f=0;f<c;++f){var o=a.at(f);r.putByte(54^o),n.putByte(92^o)}if(c<e.blockLength)for(var o=e.blockLength-c,f=0;f<o;++f)r.putByte(54),n.putByte(92);t=a,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var lr=P(()=>{});var Xo=P((y2,Qo)=>{var _t=J();Yo();$e();dt();var Th=_t.pkcs5=_t.pkcs5||{},me;_t.util.isNodejs&&!_t.options.usePureJavaScript&&(me=lr());Qo.exports=_t.pbkdf2=Th.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),_t.util.isNodejs&&!_t.options.usePureJavaScript&&me.pbkdf2&&(i===null||typeof i!="object")&&(me.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?me.pbkdf2Sync.length===4?me.pbkdf2(t,e,r,n,function(A,L){if(A)return s(A);s(null,L.toString("binary"))}):me.pbkdf2(t,e,r,n,i,function(A,L){if(A)return s(A);s(null,L.toString("binary"))}):me.pbkdf2Sync.length===4?me.pbkdf2Sync(t,e,r,n).toString("binary"):me.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in _t.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=_t.md[i].create()}var a=i.digestLength;if(n>4294967295*a){var o=new Error("Derived key is too long.");if(s)return s(o);throw o}var f=Math.ceil(n/a),c=n-(f-1)*a,u=_t.hmac.create();u.start(i,t);var h="",l,d,p;if(!s){for(var g=1;g<=f;++g){u.start(null,null),u.update(e),u.update(_t.util.int32ToBytes(g)),l=p=u.digest().getBytes();for(var x=2;x<=r;++x)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=_t.util.xorBytes(l,d,a),p=d;h+=g<f?l:l.substr(0,c)}return h}var g=1,x;function v(){if(g>f)return s(null,h);u.start(null,null),u.update(e),u.update(_t.util.int32ToBytes(g)),l=p=u.digest().getBytes(),x=2,B()}function B(){if(x<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=_t.util.xorBytes(l,d,a),p=d,++x,_t.util.setImmediate(B);h+=g<f?l:l.substr(0,c),++g,v()}v()}});var t0=P((g2,jo)=>{var Fn=J();dt();var Jo=jo.exports=Fn.pem=Fn.pem||{};Jo.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=On(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=On(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=On(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=On(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Fn.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};Jo.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var o={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Fn.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var f=s[2].split(i),c=0;s&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(s=u.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),g=0;g<p.length;++g)d.values.push(Ih(p[g]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function On(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,a=-1,i=0;i<e.length;++i,++s)if(s>65&&a!==-1){var o=e[a];o===","?(++a,e=e.substr(0,a)+`\r
 `+e.substr(a)):e=e.substr(0,a)+`\r
`+o+e.substr(a+1),s=i-a-1,a=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(a=i);return e}function Ih(t){return t.replace(/^\s+/,"")}});var a0=P((m2,s0)=>{var ie=J();$e();dt();var r0=s0.exports=ie.sha256=ie.sha256||{};ie.md.sha256=ie.md.algorithms.sha256=r0;r0.create=function(){n0||_h();var t=null,e=ie.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=ie.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=ie.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(i),e0(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=ie.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(ms.substr(0,n.blockLength-a));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};e0(h,r,i);var l=ie.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var ms=null,n0=!1,i0=null;function _h(){ms=String.fromCharCode(128),ms+=ie.util.fillString(String.fromCharCode(0),64),i0=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n0=!0}function e0(t,e,r){for(var n,i,s,a,o,f,c,u,h,l,d,p,g,x,v,B=r.length();B>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,g=t.h5,x=t.h6,v=t.h7,c=0;c<64;++c)a=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=x^p&(g^x),s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=v+a+o+i0[c]+e[c],i=s+f,v=x,x=g,g=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+g|0,t.h6=t.h6+x|0,t.h7=t.h7+v|0,B-=64}}});var f0=P((x2,o0)=>{var se=J();dt();var Vn=null;se.util.isNodejs&&!se.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Vn=lr());var Rh=o0.exports=se.prng=se.prng||{};Rh.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,g=se.util.createBuffer();e.key=null,x();function x(v){if(v)return u(v);if(g.length()>=c)return u(null,g.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return se.util.nextTick(function(){s(x)});var B=h(e.key,e.seed);e.generated+=B.length,g.putBytes(B),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),se.util.setImmediate(x)}},e.generateSync=function(c){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=se.util.createBuffer();p.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&a();var g=u(e.key,e.seed);e.generated+=g.length,p.putBytes(g),e.key=l(u(e.key,h(e.seed))),e.seed=d(u(e.key,e.seed))}return p.getBytes(c)};function s(c){if(e.pools[0].messageLength>=32)return o(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return c(h);e.collect(l),o(),c()})}function a(){if(e.pools[0].messageLength>=32)return o();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var l=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(c){var u=null,h=se.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(T){return l.getRandomValues(T)});var d=se.util.createBuffer();if(u)for(;d.length()<c;){var p=Math.max(1,Math.min(c-d.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{u(g);for(var x=0;x<g.length;++x)d.putInt32(g[x])}catch(T){if(!(typeof QuotaExceededError<"u"&&T instanceof QuotaExceededError))throw T}}if(d.length()<c)for(var v,B,A,L=Math.floor(Math.random()*65536);d.length()<c;){B=16807*(L&65535),v=16807*(L>>16),B+=(v&32767)<<16,B+=v>>15,B=(B&2147483647)+(B>>31),L=B&4294967295;for(var x=0;x<3;++x)A=L>>>(x<<3),A^=Math.floor(Math.random()*256),d.putByte(A&255)}return d.getBytes(c)}return Vn?(e.seedFile=function(c,u){Vn.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(c){return Vn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,h=0;h<u;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,l){function d(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){c.postMessage({forge:{prng:{err:d,bytes:p}}})})};c.addEventListener("message",u)}},e}});var zr=P((v2,xs)=>{var wt=J();gs();a0();f0();dt();(function(){if(wt.random&&wt.random.getBytes){xs.exports=wt.random;return}(function(t){var e={},r=new Array(4),n=wt.util.createBuffer();e.formatKey=function(h){var l=wt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),wt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=wt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return wt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=wt.md.sha256;function i(){var h=wt.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),a=null,o=wt.util.globalScope,f=o.crypto||o.msCrypto;if(f&&f.getRandomValues&&(a=function(h){return f.getRandomValues(h)}),wt.options.usePureJavaScript||!wt.util.isNodejs&&!a){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}s.collect(c),c=null}t&&(t().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),t().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!wt.random)wt.random=s;else for(var u in s)wt.random[u]=s[u];wt.random.createInstance=i,xs.exports=wt.random})(typeof jQuery<"u"?jQuery:null)})()});var l0=P((b2,h0)=>{var Nt=J();dt();var vs=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],c0=[1,2,3,5],Nh=function(t,e){return t<<e&65535|(t&65535)>>16-e},Dh=function(t,e){return(t&65535)>>e|t<<16-e&65535};h0.exports=Nt.rc2=Nt.rc2||{};Nt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Nt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),a=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(vs[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-s,vs[r.at(128-s)&a]),o=127-s;o>=0;o--)r.setAt(o,vs[r.at(o+1)^r.at(o+s)]);return r};var u0=function(t,e,r){var n=!1,i=null,s=null,a=null,o,f,c,u,h=[];for(t=Nt.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(o=function(p){for(c=0;c<4;c++)p[c]+=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),p[c]=Nh(p[c],c0[c]),u++},f=function(p){for(c=0;c<4;c++)p[c]+=h[p[(c+3)%4]&63]}):(o=function(p){for(c=3;c>=0;c--)p[c]=Dh(p[c],c0[c]),p[c]-=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),u--},f=function(p){for(c=3;c>=0;c--)p[c]-=h[p[(c+3)%4]&63]});var l=function(p){var g=[];for(c=0;c<4;c++){var x=i.getInt16Le();a!==null&&(r?x^=a.getInt16Le():a.putInt16Le(x)),g.push(x&65535)}u=r?0:63;for(var v=0;v<p.length;v++)for(var B=0;B<p[v][0];B++)p[v][1](g);for(c=0;c<4;c++)a!==null&&(r?a.putInt16Le(g[c]):g[c]^=a.getInt16Le()),s.putInt16Le(g[c])},d=null;return d={start:function(p,g){p&&typeof p=="string"&&(p=Nt.util.createBuffer(p)),n=!1,i=Nt.util.createBuffer(),s=g||new Nt.util.createBuffer,a=p,d.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,f],[6,o],[1,f],[5,o]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var x=i.length()===8?8:8-i.length();i.fillWithByte(x,x)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,s,!r);else{var v=s.length(),B=s.at(v-1);B>v?g=!1:s.truncate(B)}return g}},d};Nt.rc2.startEncrypting=function(t,e,r){var n=Nt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Nt.rc2.createEncryptionCipher=function(t,e){return u0(t,e,!0)};Nt.rc2.startDecrypting=function(t,e,r){var n=Nt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Nt.rc2.createDecryptionCipher=function(t,e){return u0(t,e,!1)}});var Hn=P((w2,b0)=>{var bs=J();b0.exports=bs.jsbn=bs.jsbn||{};var xe,Lh=0xdeadbeefcafe,p0=(Lh&16777215)==15715070;function w(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}bs.jsbn.BigInteger=w;function G(){return new w(null)}function kh(t,e,r,n,i,s){for(;--s>=0;){var a=e*this.data[t++]+r.data[n]+i;i=Math.floor(a/67108864),r.data[n++]=a&67108863}return i}function Ph(t,e,r,n,i,s){for(var a=e&32767,o=e>>15;--s>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=o*f+c*a;f=a*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+o*c+(i>>>30),r.data[n++]=f&1073741823}return i}function d0(t,e,r,n,i,s){for(var a=e&16383,o=e>>14;--s>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=o*f+c*a;f=a*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+o*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(w.prototype.am=d0,xe=28):p0&&navigator.appName=="Microsoft Internet Explorer"?(w.prototype.am=Ph,xe=30):p0&&navigator.appName!="Netscape"?(w.prototype.am=kh,xe=26):(w.prototype.am=d0,xe=28);w.prototype.DB=xe;w.prototype.DM=(1<<xe)-1;w.prototype.DV=1<<xe;var ws=52;w.prototype.FV=Math.pow(2,ws);w.prototype.F1=ws-xe;w.prototype.F2=2*xe-ws;var Uh="0123456789abcdefghijklmnopqrstuvwxyz",qn=new Array,pr,Ot;pr="0".charCodeAt(0);for(Ot=0;Ot<=9;++Ot)qn[pr++]=Ot;pr="a".charCodeAt(0);for(Ot=10;Ot<36;++Ot)qn[pr++]=Ot;pr="A".charCodeAt(0);for(Ot=10;Ot<36;++Ot)qn[pr++]=Ot;function y0(t){return Uh.charAt(t)}function g0(t,e){var r=qn[t.charCodeAt(e)];return r??-1}function Kh(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Mh(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Re(t){var e=G();return e.fromInt(t),e}function Oh(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var a=r==8?t[n]&255:g0(t,n);if(a<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&t[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&w.ZERO.subTo(this,this)}function Fh(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Vh(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",a=this.t,o=this.DB-a*this.DB%e;if(a-- >0)for(o<this.DB&&(n=this.data[a]>>o)>0&&(i=!0,s=y0(n));a>=0;)o<e?(n=(this.data[a]&(1<<o)-1)<<e-o,n|=this.data[--a]>>(o+=this.DB-e)):(n=this.data[a]>>(o-=e)&r,o<=0&&(o+=this.DB,--a)),n>0&&(i=!0),i&&(s+=y0(n));return i?s:"0"}function qh(){var t=G();return w.ZERO.subTo(this,t),t}function zh(){return this.s<0?this.negate():this}function Hh(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function zn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Gh(){return this.t<=0?0:this.DB*(this.t-1)+zn(this.data[this.t-1]^this.s&this.DM)}function Wh(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function $h(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Zh(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),a=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+s+1]=this.data[o]>>n|a,a=(this.data[o]&i)<<r;for(o=s-1;o>=0;--o)e.data[o]=0;e.data[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function Yh(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)e.data[a-r-1]|=(this.data[a]&s)<<i,e.data[a-r]=this.data[a]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function Qh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Xh(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&w.ZERO.subTo(e,e)}function Jh(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function jh(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=G());var s=G(),a=this.s,o=t.s,f=this.DB-zn(n.data[n.t-1]);f>0?(n.lShiftTo(f,s),i.lShiftTo(f,r)):(n.copyTo(s),i.copyTo(r));var c=s.t,u=s.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?s.data[c-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,x=g-c,v=e??G();for(s.dlShiftTo(x,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),w.ONE.dlShiftTo(c,v),v.subTo(s,s);s.t<c;)s.data[s.t++]=0;for(;--x>=0;){var B=r.data[--g]==u?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*d);if((r.data[g]+=s.am(0,B,r,x,0,c))<B)for(s.dlShiftTo(x,v),r.subTo(v,r);r.data[g]<--B;)r.subTo(v,r)}e!=null&&(r.drShiftTo(c,e),a!=o&&w.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),a<0&&w.ZERO.subTo(r,r)}}}function tl(t){var e=G();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(w.ZERO)>0&&t.subTo(e,e),e}function Ze(t){this.m=t}function el(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function rl(t){return t}function nl(t){t.divRemTo(this.m,null,t)}function il(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function sl(t,e){t.squareTo(e),this.reduce(e)}Ze.prototype.convert=el;Ze.prototype.revert=rl;Ze.prototype.reduce=nl;Ze.prototype.mulTo=il;Ze.prototype.sqrTo=sl;function al(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Ye(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function ol(t){var e=G();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(w.ZERO)>0&&this.m.subTo(e,e),e}function fl(t){var e=G();return t.copyTo(e),this.reduce(e),e}function cl(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function ul(t,e){t.squareTo(e),this.reduce(e)}function hl(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Ye.prototype.convert=ol;Ye.prototype.revert=fl;Ye.prototype.reduce=cl;Ye.prototype.mulTo=hl;Ye.prototype.sqrTo=ul;function ll(){return(this.t>0?this.data[0]&1:this.s)==0}function pl(t,e){if(t>4294967295||t<1)return w.ONE;var r=G(),n=G(),i=e.convert(this),s=zn(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var a=r;r=n,n=a}return e.revert(r)}function dl(t,e){var r;return t<256||e.isEven()?r=new Ze(e):r=new Ye(e),this.exp(t,r)}w.prototype.copyTo=Kh;w.prototype.fromInt=Mh;w.prototype.fromString=Oh;w.prototype.clamp=Fh;w.prototype.dlShiftTo=Wh;w.prototype.drShiftTo=$h;w.prototype.lShiftTo=Zh;w.prototype.rShiftTo=Yh;w.prototype.subTo=Qh;w.prototype.multiplyTo=Xh;w.prototype.squareTo=Jh;w.prototype.divRemTo=jh;w.prototype.invDigit=al;w.prototype.isEven=ll;w.prototype.exp=pl;w.prototype.toString=Vh;w.prototype.negate=qh;w.prototype.abs=zh;w.prototype.compareTo=Hh;w.prototype.bitLength=Gh;w.prototype.mod=tl;w.prototype.modPowInt=dl;w.ZERO=Re(0);w.ONE=Re(1);function yl(){var t=G();return this.copyTo(t),t}function gl(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function ml(){return this.t==0?this.s:this.data[0]<<24>>24}function xl(){return this.t==0?this.s:this.data[0]<<16>>16}function vl(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bl(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function wl(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Re(r),i=G(),s=G(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(r+s.intValue()).toString(t).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(t)+a}function Sl(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,a=0,o=0;o<t.length;++o){var f=g0(t,o);if(f<0){t.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}a=e*a+f,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(a,0)),i&&w.ZERO.subTo(this,this)}function El(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(w.ONE.shiftLeft(t-1),Ss,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(w.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Bl(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Al(t){return this.compareTo(t)==0}function Cl(t){return this.compareTo(t)<0?this:t}function Tl(t){return this.compareTo(t)>0?this:t}function Il(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function _l(t,e){return t&e}function Rl(t){var e=G();return this.bitwiseTo(t,_l,e),e}function Ss(t,e){return t|e}function Nl(t){var e=G();return this.bitwiseTo(t,Ss,e),e}function m0(t,e){return t^e}function Dl(t){var e=G();return this.bitwiseTo(t,m0,e),e}function x0(t,e){return t&~e}function Ll(t){var e=G();return this.bitwiseTo(t,x0,e),e}function kl(){for(var t=G(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Pl(t){var e=G();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Ul(t){var e=G();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Kl(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Ml(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Kl(this.data[t]);return this.s<0?this.t*this.DB:-1}function Ol(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Fl(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Ol(this.data[r]^e);return t}function Vl(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function ql(t,e){var r=w.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function zl(t){return this.changeBit(t,Ss)}function Hl(t){return this.changeBit(t,x0)}function Gl(t){return this.changeBit(t,m0)}function Wl(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function $l(t){var e=G();return this.addTo(t,e),e}function Zl(t){var e=G();return this.subTo(t,e),e}function Yl(t){var e=G();return this.multiplyTo(t,e),e}function Ql(t){var e=G();return this.divRemTo(t,e,null),e}function Xl(t){var e=G();return this.divRemTo(t,null,e),e}function Jl(t){var e=G(),r=G();return this.divRemTo(t,e,r),new Array(e,r)}function jl(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function tp(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Hr(){}function v0(t){return t}function ep(t,e,r){t.multiplyTo(e,r)}function rp(t,e){t.squareTo(e)}Hr.prototype.convert=v0;Hr.prototype.revert=v0;Hr.prototype.mulTo=ep;Hr.prototype.sqrTo=rp;function np(t){return this.exp(t,new Hr)}function ip(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function sp(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function dr(t){this.r2=G(),this.q3=G(),w.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function ap(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=G();return t.copyTo(e),this.reduce(e),e}function op(t){return t}function fp(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function cp(t,e){t.squareTo(e),this.reduce(e)}function up(t,e,r){t.multiplyTo(e,r),this.reduce(r)}dr.prototype.convert=ap;dr.prototype.revert=op;dr.prototype.reduce=fp;dr.prototype.mulTo=up;dr.prototype.sqrTo=cp;function hp(t,e){var r=t.bitLength(),n,i=Re(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Ze(e):e.isEven()?s=new dr(e):s=new Ye(e);var a=new Array,o=3,f=n-1,c=(1<<n)-1;if(a[1]=s.convert(this),n>1){var u=G();for(s.sqrTo(a[1],u);o<=c;)a[o]=G(),s.mulTo(u,a[o-2],a[o]),o+=2}var h=t.t-1,l,d=!0,p=G(),g;for(r=zn(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&c:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),o=n;!(l&1);)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),d)a[l].copyTo(i),d=!1;else{for(;o>1;)s.sqrTo(i,p),s.sqrTo(p,i),o-=2;o>0?s.sqrTo(i,p):(g=i,i=p,p=g),s.mulTo(p,a[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)s.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function lp(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function pp(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function dp(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return w.ZERO;for(var r=t.clone(),n=this.clone(),i=Re(1),s=Re(0),a=Re(0),o=Re(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!a.isEven()||!o.isEven())&&(a.addTo(this,a),o.subTo(t,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(a,i),s.subTo(o,s)):(n.subTo(r,n),e&&a.subTo(i,a),o.subTo(s,o))}if(n.compareTo(w.ONE)!=0)return w.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var $t=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],yp=(1<<26)/$t[$t.length-1];function gp(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=$t[$t.length-1]){for(e=0;e<$t.length;++e)if(r.data[0]==$t[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<$t.length;){for(var n=$t[e],i=e+1;i<$t.length&&n<yp;)n*=$t[i++];for(n=r.modInt(n);e<i;)if(n%$t[e++]==0)return!1}return r.millerRabin(t)}function mp(t){var e=this.subtract(w.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=xp(),s,a=0;a<t;++a){do s=new w(this.bitLength(),i);while(s.compareTo(w.ONE)<=0||s.compareTo(e)>=0);var o=s.modPow(n,this);if(o.compareTo(w.ONE)!=0&&o.compareTo(e)!=0){for(var f=1;f++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(w.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function xp(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}w.prototype.chunkSize=vl;w.prototype.toRadix=wl;w.prototype.fromRadix=Sl;w.prototype.fromNumber=El;w.prototype.bitwiseTo=Il;w.prototype.changeBit=ql;w.prototype.addTo=Wl;w.prototype.dMultiply=jl;w.prototype.dAddOffset=tp;w.prototype.multiplyLowerTo=ip;w.prototype.multiplyUpperTo=sp;w.prototype.modInt=pp;w.prototype.millerRabin=mp;w.prototype.clone=yl;w.prototype.intValue=gl;w.prototype.byteValue=ml;w.prototype.shortValue=xl;w.prototype.signum=bl;w.prototype.toByteArray=Bl;w.prototype.equals=Al;w.prototype.min=Cl;w.prototype.max=Tl;w.prototype.and=Rl;w.prototype.or=Nl;w.prototype.xor=Dl;w.prototype.andNot=Ll;w.prototype.not=kl;w.prototype.shiftLeft=Pl;w.prototype.shiftRight=Ul;w.prototype.getLowestSetBit=Ml;w.prototype.bitCount=Fl;w.prototype.testBit=Vl;w.prototype.setBit=zl;w.prototype.clearBit=Hl;w.prototype.flipBit=Gl;w.prototype.add=$l;w.prototype.subtract=Zl;w.prototype.multiply=Yl;w.prototype.divide=Ql;w.prototype.remainder=Xl;w.prototype.divideAndRemainder=Jl;w.prototype.modPow=hp;w.prototype.modInverse=dp;w.prototype.pow=np;w.prototype.gcd=lp;w.prototype.isProbablePrime=gp});var A0=P((S2,B0)=>{var ae=J();$e();dt();var S0=B0.exports=ae.sha1=ae.sha1||{};ae.md.sha1=ae.md.algorithms.sha1=S0;S0.create=function(){E0||vp();var t=null,e=ae.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=ae.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=ae.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(i),w0(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=ae.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(Es.substr(0,n.blockLength-a));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};w0(h,r,i);var l=ae.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Es=null,E0=!1;function vp(){Es=String.fromCharCode(128),Es+=ae.util.fillString(String.fromCharCode(0),64),E0=!0}function w0(t,e,r){for(var n,i,s,a,o,f,c,u,h=r.length();h>=64;){for(i=t.h0,s=t.h1,a=t.h2,o=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=o^s&(a^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=o^s&(a^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=s&a|o&(s^a),n=(i<<5|i>>>27)+c+f+2400959708+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+3395469782+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+a|0,t.h3=t.h3+o|0,t.h4=t.h4+f|0,h-=64}}});var I0=P((E2,T0)=>{var oe=J();dt();zr();A0();var C0=T0.exports=oe.pkcs1=oe.pkcs1||{};C0.encode_rsa_oaep=function(t,e,r){var n,i,s,a;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=oe.md.sha1.create(),a||(a=s);var o=Math.ceil(t.n.bitLength()/8),f=o-2*s.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),s.update(n,"raw");for(var u=s.digest(),h="",l=f-e.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+e;if(!i)i=oe.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=s.digestLength,c}var g=Gn(i,o-s.digestLength-1,a),x=oe.util.xorBytes(p,g,p.length),v=Gn(x,s.digestLength,a),B=oe.util.xorBytes(i,v,i.length);return"\0"+B+x};C0.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(t.n.bitLength()/8);if(e.length!==a){var x=new Error("RSAES-OAEP encoded message length is invalid.");throw x.length=e.length,x.expectedLength=a,x}if(i===void 0?i=oe.md.sha1.create():i.start(),s||(s=i),a<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=Gn(u,i.digestLength,s),l=oe.util.xorBytes(c,h,c.length),d=Gn(l,a-i.digestLength-1,s),p=oe.util.xorBytes(u,d,u.length),g=p.substring(0,i.digestLength),x=f!=="\0",v=0;v<i.digestLength;++v)x|=o.charAt(v)!==g.charAt(v);for(var B=1,A=i.digestLength,L=i.digestLength;L<p.length;L++){var T=p.charCodeAt(L),_=T&1^1,F=B?65534:0;x|=T&F,B=B&_,A+=B}if(x||p.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(A+1)};function Gn(t,e,r){r||(r=oe.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+a),n+=r.digest().getBytes()}return n.substring(0,e)}});var _0=P((B2,Bs)=>{var Ne=J();dt();Hn();zr();(function(){if(Ne.prime){Bs.exports=Ne.prime;return}var t=Bs.exports=Ne.prime=Ne.prime||{},e=Ne.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||Ne.random,x={nextBytes:function(v){for(var B=g.getBytesSync(v.length),A=0;A<v.length;++A)v[A]=B.charCodeAt(A)}};if(p.name==="PRIMEINC")return s(h,x,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,d,p){return"workers"in d?f(h,l,d,p):a(h,l,d,p)}function a(h,l,d,p){var g=c(h,l),x=0,v=u(g.bitLength());"millerRabinTests"in d&&(v=d.millerRabinTests);var B=10;"maxBlockTime"in d&&(B=d.maxBlockTime),o(g,h,l,x,v,B,p)}function o(h,l,d,p,g,x,v){var B=+new Date;do{if(h.bitLength()>l&&(h=c(l,d)),h.isProbablePrime(g))return v(null,h);h.dAddOffset(r[p++%8],0)}while(x<0||+new Date-B<x);Ne.util.setImmediate(function(){o(h,l,d,p,g,x,v)})}function f(h,l,d,p){if(typeof Worker>"u")return a(h,l,d,p);var g=c(h,l),x=d.workers,v=d.workLoad||100,B=v*30/8,A=d.workerScript||"forge/prime.worker.js";if(x===-1)return Ne.util.estimateCores(function(T,_){T&&(_=2),x=_-1,L()});L();function L(){x=Math.max(1,x);for(var T=[],_=0;_<x;++_)T[_]=new Worker(A);for(var F=x,_=0;_<x;++_)T[_].addEventListener("message",Et);var $=!1;function Et(zt){if(!$){--F;var kt=zt.data;if(kt.found){for(var Tt=0;Tt<T.length;++Tt)T[Tt].terminate();return $=!0,p(null,new e(kt.prime,16))}g.bitLength()>h&&(g=c(h,l));var nr=g.toString(16);zt.target.postMessage({hex:nr,workLoad:v}),g.dAddOffset(B,0)}}}}function c(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var $n=P((A2,U0)=>{var D=J();qr();Hn();Dn();I0();_0();zr();dt();typeof V>"u"&&(V=D.jsbn.BigInteger);var V,As=D.util.isNodejs?lr():null,m=D.asn1,Ft=D.util;D.pki=D.pki||{};U0.exports=D.pki.rsa=D.rsa=D.rsa||{};var U=D.pki,bp=[6,4,2,4,2,4,6,2],wp={name:"PrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Sp={name:"RSAPrivateKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Ep={name:"RSAPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Bp=D.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Ap={name:"DigestInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:m.Class.UNIVERSAL,type:m.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Cp=function(t){var e;if(t.algorithm in U.oids)e=U.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=m.oidToDer(e).getBytes(),i=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[]),s=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[]);s.value.push(m.create(m.Class.UNIVERSAL,m.Type.OID,!1,n)),s.value.push(m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,""));var a=m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(a),m.toDer(i).getBytes()},k0=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(V.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(V.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new V(D.util.bytesToHex(D.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(V.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var a=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return a=a.multiply(n.modInverse(e.n)).mod(e.n),a};U.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=P0(t,e,r)):(i=D.util.createBuffer(),i.putBytes(t));for(var a=new V(i.toHex(),16),o=k0(a,e,n),f=o.toString(16),c=D.util.createBuffer(),u=s-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(D.util.hexToBytes(f)),c.getBytes()};U.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var a=new V(D.util.createBuffer(t).toHex(),16);if(a.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=k0(a,e,r),f=o.toString(16),c=D.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(D.util.hexToBytes(f)),n!==!1?Wn(c.getBytes(),e,r):c.getBytes()};U.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||D.random,i={nextBytes:function(o){for(var f=n.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=f.charCodeAt(c)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new V(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};U.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new V(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,a,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new V(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(V.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(Ip(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(bp[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(V.ONE).gcd(t.e).compareTo(V.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(V.ONE),t.q1=t.q.subtract(V.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(V.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:U.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:U.rsa.setPublicKey(t.n,t.e)}}a=+new Date,o+=a-s,s=a}return t.keys!==null};U.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!D.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(R0("generateKeyPair"))return As.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,f,c){if(o)return n(o);n(null,{privateKey:U.privateKeyFromPem(c),publicKey:U.publicKeyFromPem(f)})});if(N0("generateKey")&&N0("exportKey"))return Ft.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:L0(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return Ft.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var f=U.privateKeyFromAsn1(m.fromDer(D.util.createBuffer(o)));n(null,{privateKey:f,publicKey:U.setRsaPublicKey(f.n,f.e)})}});if(D0("generateKey")&&D0("exportKey")){var i=Ft.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:L0(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var f=o.target.result,c=Ft.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=U.privateKeyFromAsn1(m.fromDer(D.util.createBuffer(h)));n(null,{privateKey:l,publicKey:U.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(o){n(o)};return}}else if(R0("generateKeyPairSync")){var s=As.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:U.privateKeyFromPem(s.privateKey),publicKey:U.publicKeyFromPem(s.publicKey)}}}var a=U.rsa.createKeyPairGenerationState(t,e,r);if(!n)return U.rsa.stepKeyPairGenerationState(a,0),a.keys;Tp(a,r,n)};U.setRsaPublicKey=U.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,f,c){return P0(o,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,f){return D.pkcs1.encode_rsa_oaep(f,o,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var a=i.encode(n,r,!0);return U.rsa.encrypt(a,r,!0)},r.verify=function(n,i,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(f,c){c=Wn(c,r,!0);var u=m.fromDer(c,{parseAllBytes:a._parseAllDigestBytes}),h={},l=[];if(!m.validate(u,Ap,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=m.derToOid(h.algorithmIdentifier);if(!(p===D.oids.md2||p===D.oids.md5||p===D.oids.sha1||p===D.oids.sha224||p===D.oids.sha256||p===D.oids.sha384||p===D.oids.sha512||p===D.oids["sha512-224"]||p===D.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===D.oids.md2||p===D.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(f,c){return c=Wn(c,r,!0),f===c}});var o=U.rsa.decrypt(i,r,!0,!1);return s.verify(n,o,r.n.bitLength())},r};U.setRsaPrivateKey=U.rsa.setPrivateKey=function(t,e,r,n,i,s,a,o){var f={n:t,e,d:r,p:n,q:i,dP:s,dQ:a,qInv:o};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=U.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Wn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return D.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Cp},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return U.rsa.encrypt(l,f,h)},f};U.wrapRsaPrivateKey=function(t){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,m.integerToDer(0).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(U.oids.rsaEncryption).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,"")]),m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,m.toDer(t).getBytes())])};U.privateKeyFromAsn1=function(t){var e={},r=[];if(m.validate(t,wp,e,r)&&(t=m.fromDer(D.util.createBuffer(e.privateKey))),e={},r=[],!m.validate(t,Sp,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,a,o,f,c,u,h;return i=D.util.createBuffer(e.privateKeyModulus).toHex(),s=D.util.createBuffer(e.privateKeyPublicExponent).toHex(),a=D.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=D.util.createBuffer(e.privateKeyPrime1).toHex(),f=D.util.createBuffer(e.privateKeyPrime2).toHex(),c=D.util.createBuffer(e.privateKeyExponent1).toHex(),u=D.util.createBuffer(e.privateKeyExponent2).toHex(),h=D.util.createBuffer(e.privateKeyCoefficient).toHex(),U.setRsaPrivateKey(new V(i,16),new V(s,16),new V(a,16),new V(o,16),new V(f,16),new V(c,16),new V(u,16),new V(h,16))};U.privateKeyToAsn1=U.privateKeyToRSAPrivateKey=function(t){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,m.integerToDer(0).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(t.n)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(t.e)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(t.d)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(t.p)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(t.q)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(t.dP)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(t.dQ)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(t.qInv))])};U.publicKeyFromAsn1=function(t){var e={},r=[];if(m.validate(t,Bp,e,r)){var n=m.derToOid(e.publicKeyOid);if(n!==U.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!m.validate(t,Ep,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=D.util.createBuffer(e.publicKeyModulus).toHex(),a=D.util.createBuffer(e.publicKeyExponent).toHex();return U.setRsaPublicKey(new V(s,16),new V(a,16))};U.publicKeyToAsn1=U.publicKeyToSubjectPublicKeyInfo=function(t){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(U.oids.rsaEncryption).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,"")]),m.create(m.Class.UNIVERSAL,m.Type.BITSTRING,!1,[U.publicKeyToRSAPublicKey(t)])])};U.publicKeyToRSAPublicKey=function(t){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(t.n)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(t.e))])};function P0(t,e,r){var n=D.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var a=i-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var f=0;f<a;++f)n.putByte(o)}else for(;a>0;){for(var c=0,u=D.random.getBytes(a),f=0;f<a;++f)o=u.charCodeAt(f),o===0?++c:n.putByte(o);a=c}return n.putByte(0),n.putBytes(t),n}function Wn(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=D.util.createBuffer(t),a=s.getByte(),o=s.getByte();if(a!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(o===0){f=i-3-n;for(var c=0;c<f;++c)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(f=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++f}else if(o===2)for(f=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++f}var u=s.getByte();if(u!==0||f!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Tp(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(o,f){if(o)return r(o);if(t.p=f,t.q!==null)return a(o,t.q);s(t.qBits,a)})}function s(o,f){D.prime.generateProbablePrime(o,n,f)}function a(o,f){if(o)return r(o);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(V.ONE).gcd(t.e).compareTo(V.ONE)!==0){t.p=null,i();return}if(t.q.subtract(V.ONE).gcd(t.e).compareTo(V.ONE)!==0){t.q=null,s(t.qBits,a);return}if(t.p1=t.p.subtract(V.ONE),t.q1=t.q.subtract(V.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(V.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,a);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:U.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:U.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function fe(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=D.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Ip(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function R0(t){return D.util.isNodejs&&typeof As[t]=="function"}function N0(t){return typeof Ft.globalScope<"u"&&typeof Ft.globalScope.crypto=="object"&&typeof Ft.globalScope.crypto.subtle=="object"&&typeof Ft.globalScope.crypto.subtle[t]=="function"}function D0(t){return typeof Ft.globalScope<"u"&&typeof Ft.globalScope.msCrypto=="object"&&typeof Ft.globalScope.msCrypto.subtle=="object"&&typeof Ft.globalScope.msCrypto.subtle[t]=="function"}function L0(t){for(var e=D.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var q0=P((C2,V0)=>{var I=J();gs();qr();Wo();$e();Dn();Xo();t0();zr();l0();$n();dt();typeof K0>"u"&&(K0=I.jsbn.BigInteger);var K0,b=I.asn1,K=I.pki=I.pki||{};V0.exports=K.pbe=I.pbe=I.pbe||{};var Qe=K.oids,_p={name:"EncryptedPrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Rp={name:"PBES2Algorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Np={name:"pkcs-12PbeParams",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"iterations"}]};K.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=I.random.getBytesSync(r.saltSize),i=r.count,s=b.integerToDer(i),a,o,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":a=16,c=16,u=Qe["aes128-CBC"],h=I.aes.createEncryptionCipher;break;case"aes192":a=24,c=16,u=Qe["aes192-CBC"],h=I.aes.createEncryptionCipher;break;case"aes256":a=32,c=16,u=Qe["aes256-CBC"],h=I.aes.createEncryptionCipher;break;case"des":a=8,c=8,u=Qe.desCBC,h=I.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=F0(d),g=I.pkcs5.pbkdf2(e,n,i,a,p),x=I.random.getBytesSync(c),v=h(g);v.start(x),v.update(b.toDer(t)),v.finish(),f=v.output.getBytes();var B=Dp(n,s,a,d);o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Qe.pkcs5PBES2).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Qe.pkcs5PBKDF2).getBytes()),B]),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(u).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,x)])])])}else if(r.algorithm==="3des"){a=24;var A=new I.util.ByteBuffer(n),g=K.pbe.generatePkcs12Key(e,A,1,i,a),x=K.pbe.generatePkcs12Key(e,A,2,i,a),v=I.des.createEncryptionCipher(g);v.start(x),v.update(b.toDer(t)),v.finish(),f=v.output.getBytes(),o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Qe["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,n),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var L=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[o,b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,f)]);return L};K.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!b.validate(t,_p,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=b.derToOid(n.encryptionOid),o=K.pbe.getCipher(a,n.encryptionParams,e),f=I.util.createBuffer(n.encryptedData);return o.update(f),o.finish()&&(r=b.fromDer(o.output)),r};K.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:b.toDer(t).getBytes()};return I.pem.encode(r,{maxline:e})};K.encryptedPrivateKeyFromPem=function(t){var e=I.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return b.fromDer(e.body)};K.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=K.wrapRsaPrivateKey(K.privateKeyToAsn1(t));return n=K.encryptPrivateKeyInfo(n,e,r),K.encryptedPrivateKeyToPem(n)}var i,s,a,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",a=16,s=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",a=24,s=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",a=32,s=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",a=24,s=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;case"des":i="DES-CBC",a=8,s=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=I.pbe.opensslDeriveBytes(e,s.substr(0,8),a),u=o(c);u.start(s),u.update(b.toDer(K.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:I.util.bytesToHex(s).toUpperCase()},body:u.output.getBytes()};return I.pem.encode(h)};K.decryptRsaPrivateKey=function(t,e){var r=null,n=I.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,a;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,a=I.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=I.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=I.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=I.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=I.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(h){return I.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,a=function(h){return I.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,a=function(h){return I.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=I.util.hexToBytes(n.dekInfo.parameters),f=I.pbe.opensslDeriveBytes(e,o.substr(0,8),s),c=a(f);if(c.start(o),c.update(I.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=K.decryptPrivateKeyInfo(b.fromDer(r),e):r=b.fromDer(r),r!==null&&(r=K.privateKeyFromAsn1(r)),r};K.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var a,o;if(typeof s>"u"||s===null){if(!("sha1"in I.md))throw new Error('"sha1" hash algorithm unavailable.');s=I.md.sha1.create()}var f=s.digestLength,c=s.blockLength,u=new I.util.ByteBuffer,h=new I.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)h.putInt16(t.charCodeAt(o));h.putInt16(0)}var l=h.length(),d=e.length(),p=new I.util.ByteBuffer;p.fillWithByte(r,c);var g=c*Math.ceil(d/c),x=new I.util.ByteBuffer;for(o=0;o<g;o++)x.putByte(e.at(o%d));var v=c*Math.ceil(l/c),B=new I.util.ByteBuffer;for(o=0;o<v;o++)B.putByte(h.at(o%l));var A=x;A.putBuffer(B);for(var L=Math.ceil(i/f),T=1;T<=L;T++){var _=new I.util.ByteBuffer;_.putBytes(p.bytes()),_.putBytes(A.bytes());for(var F=0;F<n;F++)s.start(),s.update(_.getBytes()),_=s.digest();var $=new I.util.ByteBuffer;for(o=0;o<c;o++)$.putByte(_.at(o%f));var Et=Math.ceil(d/c)+Math.ceil(l/c),zt=new I.util.ByteBuffer;for(a=0;a<Et;a++){var kt=new I.util.ByteBuffer(A.getBytes(c)),Tt=511;for(o=$.length()-1;o>=0;o--)Tt=Tt>>8,Tt+=$.at(o)+kt.at(o),kt.setAt(o,Tt&255);zt.putBuffer(kt)}A=zt,u.putBuffer(_)}return u.truncate(u.length()-i),u};K.pbe.getCipher=function(t,e,r){switch(t){case K.oids.pkcs5PBES2:return K.pbe.getCipherForPBES2(t,e,r);case K.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case K.oids["pbewithSHAAnd40BitRC2-CBC"]:return K.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};K.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!b.validate(e,Rp,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=b.derToOid(n.kdfOid),t!==K.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=b.derToOid(n.encOid),t!==K.oids["aes128-CBC"]&&t!==K.oids["aes192-CBC"]&&t!==K.oids["aes256-CBC"]&&t!==K.oids["des-EDE3-CBC"]&&t!==K.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=n.kdfSalt,o=I.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var f,c;switch(K.oids[t]){case"aes128-CBC":f=16,c=I.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=I.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=I.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=I.des.createDecryptionCipher;break;case"desCBC":f=8,c=I.des.createDecryptionCipher;break}var u=O0(n.prfOid),h=I.pkcs5.pbkdf2(r,a,o,f,u),l=n.encIv,d=c(h);return d.start(l),d};K.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!b.validate(e,Np,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=I.util.createBuffer(n.salt),o=I.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var f,c,u;switch(t){case K.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=I.des.startDecrypting;break;case K.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(g,x){var v=I.rc2.createDecryptionCipher(g,40);return v.start(x,null),v};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var h=O0(n.prfOid),l=K.pbe.generatePkcs12Key(r,a,1,o,f,h);h.start();var d=K.pbe.generatePkcs12Key(r,a,2,o,c,h);return u(l,d)};K.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in I.md))throw new Error('"md5" hash algorithm unavailable.');n=I.md.md5.create()}e===null&&(e="");for(var i=[M0(n,t+e)],s=16,a=1;s<r;++a,s+=16)i.push(M0(n,i[a-1]+t+e));return i.join("").substr(0,r)};function M0(t,e){return t.start().update(e).digest().getBytes()}function O0(t){var e;if(!t)e="hmacWithSHA1";else if(e=K.oids[b.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return F0(e)}function F0(t){var e=I.md;switch(t){case"hmacWithSHA224":e=I.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Dp(t,e,r,n){var i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,t),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,I.util.hexToBytes(r.toString(16))),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(K.oids[n]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])),i}});var Q0=P((ug,Y0)=>{var nt=J();$e();dt();var Gr=Y0.exports=nt.sha512=nt.sha512||{};nt.md.sha512=nt.md.algorithms.sha512=Gr;var $0=nt.sha384=nt.sha512.sha384=nt.sha512.sha384||{};$0.create=function(){return Gr.create("SHA-384")};nt.md.sha384=nt.md.algorithms.sha384=$0;nt.sha512.sha256=nt.sha512.sha256||{create:function(){return Gr.create("SHA-512/256")}};nt.md["sha512/256"]=nt.md.algorithms["sha512/256"]=nt.sha512.sha256;nt.sha512.sha224=nt.sha512.sha224||{create:function(){return Gr.create("SHA-512/224")}};nt.md["sha512/224"]=nt.md.algorithms["sha512/224"]=nt.sha512.sha224;Gr.create=function(t){if(Z0||Up(),typeof t>"u"&&(t="SHA-512"),!(t in Xe))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Xe[t],r=null,n=nt.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var a=64;switch(t){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var o={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var f=o.messageLengthSize/4,c=0;c<f;++c)o.fullMessageLength.push(0);n=nt.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return o},o.start(),o.update=function(f,c){c==="utf8"&&(f=nt.util.encodeUtf8(f));var u=f.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=u[1],u[1]=u[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),W0(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var f=nt.util.createBuffer();f.putBytes(n.bytes());var c=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=c&o.blockLength-1;f.putBytes(Ts.substr(0,o.blockLength-u));for(var h,l,d=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);W0(g,i,f);var x=nt.util.createBuffer(),v;t==="SHA-512"?v=g.length:t==="SHA-384"?v=g.length-2:v=g.length-4;for(var p=0;p<v;++p)x.putInt32(g[p][0]),(p!==v-1||t!=="SHA-512/224")&&x.putInt32(g[p][1]);return x},o};var Ts=null,Z0=!1,Is=null,Xe=null;function Up(){Ts=String.fromCharCode(128),Ts+=nt.util.fillString(String.fromCharCode(0),128),Is=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Xe={},Xe["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Xe["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Xe["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Xe["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Z0=!0}function W0(t,e,r){for(var n,i,s,a,o,f,c,u,h,l,d,p,g,x,v,B,A,L,T,_,F,$,Et,zt,kt,Tt,nr,yn,pt,Rt,k,yi,gi,mi,xi,ga=r.length();ga>=128;){for(pt=0;pt<16;++pt)e[pt][0]=r.getInt32()>>>0,e[pt][1]=r.getInt32()>>>0;for(;pt<80;++pt)yi=e[pt-2],Rt=yi[0],k=yi[1],n=((Rt>>>19|k<<13)^(k>>>29|Rt<<3)^Rt>>>6)>>>0,i=((Rt<<13|k>>>19)^(k<<3|Rt>>>29)^(Rt<<26|k>>>6))>>>0,mi=e[pt-15],Rt=mi[0],k=mi[1],s=((Rt>>>1|k<<31)^(Rt>>>8|k<<24)^Rt>>>7)>>>0,a=((Rt<<31|k>>>1)^(Rt<<24|k>>>8)^(Rt<<25|k>>>7))>>>0,gi=e[pt-7],xi=e[pt-16],k=i+gi[1]+a+xi[1],e[pt][0]=n+gi[0]+s+xi[0]+(k/4294967296>>>0)>>>0,e[pt][1]=k>>>0;for(g=t[0][0],x=t[0][1],v=t[1][0],B=t[1][1],A=t[2][0],L=t[2][1],T=t[3][0],_=t[3][1],F=t[4][0],$=t[4][1],Et=t[5][0],zt=t[5][1],kt=t[6][0],Tt=t[6][1],nr=t[7][0],yn=t[7][1],pt=0;pt<80;++pt)c=((F>>>14|$<<18)^(F>>>18|$<<14)^($>>>9|F<<23))>>>0,u=((F<<18|$>>>14)^(F<<14|$>>>18)^($<<23|F>>>9))>>>0,h=(kt^F&(Et^kt))>>>0,l=(Tt^$&(zt^Tt))>>>0,o=((g>>>28|x<<4)^(x>>>2|g<<30)^(x>>>7|g<<25))>>>0,f=((g<<4|x>>>28)^(x<<30|g>>>2)^(x<<25|g>>>7))>>>0,d=(g&v|A&(g^v))>>>0,p=(x&B|L&(x^B))>>>0,k=yn+u+l+Is[pt][1]+e[pt][1],n=nr+c+h+Is[pt][0]+e[pt][0]+(k/4294967296>>>0)>>>0,i=k>>>0,k=f+p,s=o+d+(k/4294967296>>>0)>>>0,a=k>>>0,nr=kt,yn=Tt,kt=Et,Tt=zt,Et=F,zt=$,k=_+i,F=T+n+(k/4294967296>>>0)>>>0,$=k>>>0,T=A,_=L,A=v,L=B,v=g,B=x,k=i+a,g=n+s+(k/4294967296>>>0)>>>0,x=k>>>0;k=t[0][1]+x,t[0][0]=t[0][0]+g+(k/4294967296>>>0)>>>0,t[0][1]=k>>>0,k=t[1][1]+B,t[1][0]=t[1][0]+v+(k/4294967296>>>0)>>>0,t[1][1]=k>>>0,k=t[2][1]+L,t[2][0]=t[2][0]+A+(k/4294967296>>>0)>>>0,t[2][1]=k>>>0,k=t[3][1]+_,t[3][0]=t[3][0]+T+(k/4294967296>>>0)>>>0,t[3][1]=k>>>0,k=t[4][1]+$,t[4][0]=t[4][0]+F+(k/4294967296>>>0)>>>0,t[4][1]=k>>>0,k=t[5][1]+zt,t[5][0]=t[5][0]+Et+(k/4294967296>>>0)>>>0,t[5][1]=k>>>0,k=t[6][1]+Tt,t[6][0]=t[6][0]+kt+(k/4294967296>>>0)>>>0,t[6][1]=k>>>0,k=t[7][1]+yn,t[7][0]=t[7][0]+nr+(k/4294967296>>>0)>>>0,t[7][1]=k>>>0,ga-=128}}});var yc=P((px,dc)=>{dc.exports=sa;var pc=128,ey=127,ry=~ey,ny=Math.pow(2,31);function sa(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw sa.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=ny;)e[r++]=t&255|pc,t/=128;for(;t&ry;)e[r++]=t&255|pc,t>>>=7;return e[r]=t|0,sa.bytes=r-n+1,e}});var xc=P((dx,mc)=>{mc.exports=aa;var iy=128,gc=127;function aa(t,n){var r=0,n=n||0,i=0,s=n,a,o=t.length;do{if(s>=o||i>49)throw aa.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=i<28?(a&gc)<<i:(a&gc)*Math.pow(2,i),i+=7}while(a>=iy);return aa.bytes=s-n,r}});var bc=P((yx,vc)=>{var sy=Math.pow(2,7),ay=Math.pow(2,14),oy=Math.pow(2,21),fy=Math.pow(2,28),cy=Math.pow(2,35),uy=Math.pow(2,42),hy=Math.pow(2,49),ly=Math.pow(2,56),py=Math.pow(2,63);vc.exports=function(t){return t<sy?1:t<ay?2:t<oy?3:t<fy?4:t<cy?5:t<uy?6:t<hy?7:t<ly?8:t<py?9:10}});var hi=P((gx,wc)=>{wc.exports={encode:yc(),decode:xc(),encodingLength:bc()}});var Lc=P((Rx,Dc)=>{"use strict";function Nc(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function Iy(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return Nc(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),Nc(new i,r)}}Dc.exports=Iy});var Ly={};Bt(Ly,{PeerRecord:()=>qt,RecordEnvelope:()=>Xt});var Y=class extends Error{constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var Ei={};Bt(Ei,{identity:()=>Jc});function $c(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var o=t.length,f=t.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,x=0,v=0,B=p.length;v!==B&&p[v]===0;)v++,g++;for(var A=(B-v)*u+1>>>0,L=new Uint8Array(A);v!==B;){for(var T=p[v],_=0,F=A-1;(T!==0||_<x)&&F!==-1;F--,_++)T+=256*L[F]>>>0,L[F]=T%o>>>0,T=T/o>>>0;if(T!==0)throw new Error("Non-zero carry");x=_,v++}for(var $=A-x;$!==A&&L[$]===0;)$++;for(var Et=f.repeat(g);$<A;++$)Et+=t.charAt(L[$]);return Et}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var x=0,v=0;p[g]===f;)x++,g++;for(var B=(p.length-g)*c+1>>>0,A=new Uint8Array(B);p[g];){var L=r[p.charCodeAt(g)];if(L===255)return;for(var T=0,_=B-1;(L!==0||T<v)&&_!==-1;_--,T++)L+=o*A[_]>>>0,A[_]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");v=T,g++}if(p[g]!==" "){for(var F=B-v;F!==B&&A[F]===0;)F++;for(var $=new Uint8Array(x+(B-F)),Et=x;F!==B;)$[Et++]=A[F++];return $}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Zc=$c,Yc=Zc,xa=Yc;var Ky=new Uint8Array(0);var va=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},le=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var ba=t=>new TextEncoder().encode(t),wa=t=>new TextDecoder().decode(t);var vi=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},bi=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ea(this,e)}},wi=class{constructor(e){this.decoders=e}or(e){return Ea(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Ea=(t,e)=>new wi({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Si=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new vi(e,r,n),this.decoder=new bi(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},ir=({name:t,prefix:e,encode:r,decode:n})=>new Si(t,e,r,n),Se=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=xa(r,e);return ir({prefix:t,name:e,encode:n,decode:s=>le(i(s))})},Qc=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=t.length;for(;t[s-1]==="=";)--s;let a=new Uint8Array(s*r/8|0),o=0,f=0,c=0;for(let u=0;u<s;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,o+=r,o>=8&&(o-=8,a[c++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return a},Xc=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,s="",a=0,o=0;for(let f=0;f<t.length;++f)for(o=o<<8|t[f],a+=8;a>r;)a-=r,s+=e[i&o>>a];if(a&&(s+=e[i&o<<r-a]),n)for(;s.length*r&7;)s+="=";return s},ut=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ir({prefix:e,name:t,encode(i){return Xc(i,n,r)},decode(i){return Qc(i,n,r,t)}});var Jc=ir({prefix:"\0",name:"identity",encode:t=>wa(t),decode:t=>ba(t)});var Bi={};Bt(Bi,{base2:()=>jc});var jc=ut({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ai={};Bt(Ai,{base8:()=>tu});var tu=ut({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ci={};Bt(Ci,{base10:()=>eu});var eu=Se({prefix:"9",name:"base10",alphabet:"0123456789"});var Ti={};Bt(Ti,{base16:()=>ru,base16upper:()=>nu});var ru=ut({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),nu=ut({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ii={};Bt(Ii,{base32:()=>pe,base32hex:()=>ou,base32hexpad:()=>cu,base32hexpadupper:()=>uu,base32hexupper:()=>fu,base32pad:()=>su,base32padupper:()=>au,base32upper:()=>iu,base32z:()=>hu});var pe=ut({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),iu=ut({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),su=ut({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),au=ut({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ou=ut({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),fu=ut({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cu=ut({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),uu=ut({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hu=ut({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var _i={};Bt(_i,{base36:()=>lu,base36upper:()=>pu});var lu=Se({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),pu=Se({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ri={};Bt(Ri,{base58btc:()=>yt,base58flickr:()=>du});var yt=Se({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),du=Se({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ni={};Bt(Ni,{base64:()=>mn,base64pad:()=>yu,base64url:()=>gu,base64urlpad:()=>mu});var mn=ut({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),yu=ut({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),gu=ut({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),mu=ut({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Di={};Bt(Di,{base256emoji:()=>Su});var Ba=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),xu=Ba.reduce((t,e,r)=>(t[r]=e,t),[]),vu=Ba.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function bu(t){return t.reduce((e,r)=>(e+=xu[r],e),"")}function wu(t){let e=[];for(let r of t){let n=vu[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Su=ir({prefix:"\u{1F680}",name:"base256emoji",encode:bu,decode:wu});var Ui={};Bt(Ui,{sha256:()=>At,sha512:()=>Vu});var Eu=Ta,Aa=128,Bu=127,Au=~Bu,Cu=Math.pow(2,31);function Ta(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Cu;)e[r++]=t&255|Aa,t/=128;for(;t&Au;)e[r++]=t&255|Aa,t>>>=7;return e[r]=t|0,Ta.bytes=r-n+1,e}var Tu=Li,Iu=128,Ca=127;function Li(t,n){var r=0,n=n||0,i=0,s=n,a,o=t.length;do{if(s>=o)throw Li.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=i<28?(a&Ca)<<i:(a&Ca)*Math.pow(2,i),i+=7}while(a>=Iu);return Li.bytes=s-n,r}var _u=Math.pow(2,7),Ru=Math.pow(2,14),Nu=Math.pow(2,21),Du=Math.pow(2,28),Lu=Math.pow(2,35),ku=Math.pow(2,42),Pu=Math.pow(2,49),Uu=Math.pow(2,56),Ku=Math.pow(2,63),Mu=function(t){return t<_u?1:t<Ru?2:t<Nu?3:t<Du?4:t<Lu?5:t<ku?6:t<Pu?7:t<Uu?8:t<Ku?9:10},Ou={encode:Eu,decode:Tu,encodingLength:Mu},Fu=Ou,kr=Fu;var Pr=(t,e=0)=>[kr.decode(t,e),kr.decode.bytes],sr=(t,e,r=0)=>(kr.encode(t,e,r),e),ar=t=>kr.encodingLength(t);var Jt=(t,e)=>{let r=e.byteLength,n=ar(t),i=n+ar(r),s=new Uint8Array(i+r);return sr(t,s,0),sr(r,s,n),s.set(e,i),new or(t,r,e,s)},Ve=t=>{let e=le(t),[r,n]=Pr(e),[i,s]=Pr(e.subarray(n)),a=e.subarray(n+s);if(a.byteLength!==i)throw new Error("Incorrect length");return new or(r,i,a,e)},Ia=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&va(t.bytes,r.bytes)}},or=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var Pi=({name:t,code:e,encode:r})=>new ki(t,e,r),ki=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Jt(this.code,r):r.then(n=>Jt(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Ra=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),At=Pi({name:"sha2-256",code:18,encode:Ra("SHA-256")}),Vu=Pi({name:"sha2-512",code:19,encode:Ra("SHA-512")});var Ki={};Bt(Ki,{identity:()=>Ee});var Na=0,qu="identity",Da=le,zu=t=>Jt(Na,Da(t)),Ee={code:Na,name:qu,encode:Da,digest:zu};var i1=new TextEncoder,s1=new TextDecoder;var La=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return $u(r,Mi(t),e||yt.encoder);default:return Zu(r,Mi(t),e||pe.encoder)}};var ka=new WeakMap,Mi=t=>{let e=ka.get(t);if(e==null){let r=new Map;return ka.set(t,r),r}return e},j=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Ur)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Yu)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return j.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Jt(e,r);return j.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return j.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Ia(e.multihash,n.multihash)}toString(e){return La(this,e)}toJSON(){return{"/":La(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof j)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:a}=r;return new j(n,i,s,a||Pa(n,i,s.bytes))}else if(r[Qu]===!0){let{version:n,multihash:i,code:s}=r,a=Ve(i);return j.create(n,s,a)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Ur)throw new Error(`Version 0 CID must use dag-pb (code: ${Ur}) block encoding`);return new j(e,r,n,n.bytes)}case 1:{let i=Pa(e,r,n.bytes);return new j(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return j.create(0,Ur,e)}static createV1(e,r){return j.create(1,e,r)}static decode(e){let[r,n]=j.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=j.inspectBytes(e),n=r.size-r.multihashSize,i=le(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),a=new or(r.multihashCode,r.digestSize,s,i);return[r.version===0?j.createV0(a):j.createV1(r.codec,a),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Pr(e.subarray(r));return r+=l,h},i=n(),s=Ur;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let a=r,o=n(),f=n(),c=r+f,u=c-a;return{version:i,codec:s,multihashCode:o,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=Wu(e,r),s=j.decode(i);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Mi(s).set(n,e),s}},Wu=(t,e)=>{switch(t[0]){case"Q":{let r=e||yt;return[yt.prefix,r.decode(`${yt.prefix}${t}`)]}case yt.prefix:{let r=e||yt;return[yt.prefix,r.decode(t)]}case pe.prefix:{let r=e||pe;return[pe.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},$u=(t,e,r)=>{let{prefix:n}=r;if(n!==yt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return i},Zu=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let s=r.encode(t);return e.set(n,s),s}else return i},Ur=112,Yu=18,Pa=(t,e,r)=>{let n=ar(t),i=n+ar(e),s=new Uint8Array(i+r.byteLength);return sr(t,s,0),sr(e,s,n),s.set(r,i),s},Qu=Symbol.for("@ipld/js-cid/CID");var Be={...Ei,...Bi,...Ai,...Ci,...Ti,...Ii,..._i,...Ri,...Ni,...Di},y1={...Ui,...Ki};function ze(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function de(t=0){return globalThis.Buffer?.alloc!=null?ze(globalThis.Buffer.alloc(t)):new Uint8Array(t)}function ye(t=0){return globalThis.Buffer?.allocUnsafe!=null?ze(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Ka(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Ua=Ka("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Oi=Ka("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=ye(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Xu={utf8:Ua,"utf-8":Ua,hex:Be.base16,latin1:Oi,ascii:Oi,binary:Oi,...Be},vn=Xu;function Ct(t,e="utf8"){let r=vn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ze(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function gt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Ji=X(En(),1),Eo=X(Hi(),1),ji=X(An(),1),Bo=X(Xi(),1),Ao=X(Ce(),1);function ah(){Ao.default._configure(),Ji.default._configure(Eo.default),ji.default._configure(Bo.default)}ah();var Co=["uint64","int64","sint64","fixed64","sfixed64"];function oh(t){for(let e of Co){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function ts(t){return oh(new Ji.default(t))}function fh(t){for(let e of Co){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function es(){return fh(ji.default.create())}function Cn(t,e){let r=ts(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function Tn(t,e){let r=es();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var cr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(cr||(cr={}));function In(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function rs(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(s,a){let o=e(s);a.int32(o)},n=function(s){let a=s.int32();return e(a)};return In("enum",cr.VARINT,r,n)}function _n(t,e){return In("message",cr.LENGTH_DELIMITED,t,e)}var at;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(at||(at={}));var ns;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(ns||(ns={}));(function(t){t.codec=()=>rs(ns)})(at||(at={}));var ee;(function(t){let e;t.codec=()=>(e==null&&(e=_n((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),at.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=at.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),e),t.encode=r=>Tn(r,t.codec()),t.decode=r=>Cn(r,t.codec())})(ee||(ee={}));var re;(function(t){let e;t.codec=()=>(e==null&&(e=_n((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),at.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=at.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),e),t.encode=r=>Tn(r,t.codec()),t.decode=r=>Cn(r,t.codec())})(re||(re={}));var tm=X(qr(),1),em=X(q0(),1),Ld=X(J(),1);function mt(t,e){e==null&&(e=t.reduce((i,s)=>i+s.length,0));let r=ye(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return ze(r)}var Dt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var q2=X(dt(),1),z2=X(Hn(),1),z0=X(J(),1);function tt(t,e="utf8"){let r=vn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Zt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=mt([new Uint8Array(e-r.length),r])}return tt(r,"base64url")}function Pt(t){let e=H0(t);return new z0.default.jsbn.BigInteger(tt(e,"base16"),16)}function H0(t,e){let r=Ct(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=mt([new Uint8Array(e-r.length),r])}return r}var kp={"P-256":256,"P-384":384,"P-521":521},Pp=Object.keys(kp),tg=Pp.join(" / ");function Cs(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",s=t?.saltLength??16,a=t?.iterations??32767,o=Dt.get();r*=8;async function f(h,l){let d=o.getRandomValues(new Uint8Array(s)),p=o.getRandomValues(new Uint8Array(n)),g={name:e,iv:p};typeof l=="string"&&(l=Ct(l));let x={name:"PBKDF2",salt:d,iterations:a,hash:{name:i}},v=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),B=await o.subtle.deriveKey(x,v,{name:e,length:r},!0,["encrypt"]),A=await o.subtle.encrypt(g,B,h);return mt([d,g.iv,new Uint8Array(A)])}async function c(h,l){let d=h.subarray(0,s),p=h.subarray(s,s+n),g=h.subarray(s+n),x={name:e,iv:p};typeof l=="string"&&(l=Ct(l));let v={name:"PBKDF2",salt:d,iterations:a,hash:{name:i}},B=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),A=await o.subtle.deriveKey(v,B,{name:e,length:r},!0,["decrypt"]),L=await o.subtle.decrypt(x,A,g);return new Uint8Array(L)}return{encrypt:f,decrypt:c}}var Ks={};Bt(Ks,{RsaPrivateKey:()=>Sr,RsaPublicKey:()=>Xr,fromJwk:()=>ad,generateKeyPair:()=>od,unmarshalRsaPrivateKey:()=>id,unmarshalRsaPublicKey:()=>sd});var Pg=X(Q0(),1),Qr=X(J(),1);var Kp=X(lr(),1);var q=BigInt(0),it=BigInt(1),Le=BigInt(2),$r=BigInt(3),X0=BigInt(8),ht=Object.freeze({a:q,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:it,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),J0=(t,e)=>(t+e/Le)/e,Zn={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(t){let{n:e}=ht,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-it*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=BigInt("0x100000000000000000000000000000000"),o=J0(s*t,e),f=J0(-n*t,e),c=R(t-o*r-f*i,e),u=R(-o*n-f*s,e),h=c>a,l=u>a;if(h&&(c=e-c),l&&(u=e-u),c>a||u>a)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:l,k2:u}}},Yt=32,mr=32,Mp=32,j0=Yt+1,tf=2*Yt+1;function ef(t){let{a:e,b:r}=ht,n=R(t*t),i=R(n*t);return R(i+e*t+r)}var Yn=ht.a===q,Jn=class extends Error{constructor(e){super(e)}};function rf(t){if(!(t instanceof W))throw new TypeError("JacobianPoint expected")}var W=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof Z))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(Z.ZERO)?W.ZERO:new W(e.x,e.y,it)}static toAffineBatch(e){let r=zp(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return W.toAffineBatch(e).map(W.fromAffine)}equals(e){rf(e);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=e,f=R(i*i),c=R(o*o),u=R(r*c),h=R(s*f),l=R(R(n*o)*c),d=R(R(a*i)*f);return u===h&&l===d}negate(){return new W(this.x,R(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=R(e*e),s=R(r*r),a=R(s*s),o=e+s,f=R(Le*(R(o*o)-i-a)),c=R($r*i),u=R(c*c),h=R(u-Le*f),l=R(c*(f-h)-X0*a),d=R(Le*r*n);return new W(h,l,d)}add(e){rf(e);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=e;if(s===q||a===q)return this;if(r===q||n===q)return e;let f=R(i*i),c=R(o*o),u=R(r*c),h=R(s*f),l=R(R(n*o)*c),d=R(R(a*i)*f),p=R(h-u),g=R(d-l);if(p===q)return g===q?this.double():W.ZERO;let x=R(p*p),v=R(p*x),B=R(u*x),A=R(g*g-v-Le*B),L=R(g*(B-A)-l*v),T=R(i*o*p);return new W(A,L,T)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=W.ZERO;if(typeof e=="bigint"&&e===q)return r;let n=af(e);if(n===it)return this;if(!Yn){let h=r,l=this;for(;n>q;)n&it&&(h=h.add(l)),l=l.double(),n>>=it;return h}let{k1neg:i,k1:s,k2neg:a,k2:o}=Zn.splitScalar(n),f=r,c=r,u=this;for(;s>q||o>q;)s&it&&(f=f.add(u)),o&it&&(c=c.add(u)),u=u.double(),s>>=it,o>>=it;return i&&(f=f.negate()),a&&(c=c.negate()),c=new W(R(c.x*Zn.beta),c.y,c.z),f.add(c)}precomputeWindow(e){let r=Yn?128/e+1:256/e+1,n=[],i=this,s=i;for(let a=0;a<r;a++){s=i,n.push(s);for(let o=1;o<2**(e-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(W.BASE)&&(r=Z.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Rs.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=W.normalizeZ(i),Rs.set(r,i)));let s=W.ZERO,a=W.BASE,o=1+(Yn?128/n:256/n),f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(e&c);e>>=h,p>f&&(p-=u,e+=it);let g=d,x=d+Math.abs(p)-1,v=l%2!==0,B=p<0;p===0?a=a.add(Qn(v,i[g])):s=s.add(Qn(B,i[x]))}return{p:s,f:a}}multiply(e,r){let n=af(e),i,s;if(Yn){let{k1neg:a,k1:o,k2neg:f,k2:c}=Zn.splitScalar(n),{p:u,f:h}=this.wNAF(o,r),{p:l,f:d}=this.wNAF(c,r);u=Qn(a,u),l=Qn(f,l),l=new W(R(l.x*Zn.beta),l.y,l.z),i=u.add(l),s=h.add(d)}else{let{p:a,f:o}=this.wNAF(n,r);i=a,s=o}return W.normalizeZ([i,s])[0]}toAffine(e){let{x:r,y:n,z:i}=this,s=this.equals(W.ZERO);e==null&&(e=s?X0:br(i));let a=e,o=R(a*a),f=R(o*a),c=R(r*o),u=R(n*f),h=R(i*a);if(s)return Z.ZERO;if(h!==it)throw new Error("invZ was invalid");return new Z(c,u)}};W.BASE=new W(ht.Gx,ht.Gy,it);W.ZERO=new W(q,it,q);function Qn(t,e){let r=e.negate();return t?r:e}var Rs=new WeakMap,Z=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Rs.delete(this)}hasEvenY(){return this.y%Le===q}static fromCompressedHex(e){let r=e.length===32,n=ke(r?e:e.subarray(1));if(!_s(n))throw new Error("Point is not on curve");let i=ef(n),s=qp(i),a=(s&it)===it;r?a&&(s=R(-s)):(e[0]&1)===1!==a&&(s=R(-s));let o=new Z(n,s);return o.assertValidity(),o}static fromUncompressedHex(e){let r=ke(e.subarray(1,Yt+1)),n=ke(e.subarray(Yt+1,Yt*2+1)),i=new Z(r,n);return i.assertValidity(),i}static fromHex(e){let r=vr(e),n=r.length,i=r[0];if(n===Yt)return this.fromCompressedHex(r);if(n===j0&&(i===2||i===3))return this.fromCompressedHex(r);if(n===tf&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${j0} compressed bytes or ${tf} uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return Z.BASE.multiply(ti(e))}static fromSignature(e,r,n){let{r:i,s}=of(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let a=Ls(vr(e)),{n:o}=ht,f=n===2||n===3?i+o:i,c=br(f,o),u=R(-a*c,o),h=R(s*c,o),l=n&1?"03":"02",d=Z.fromHex(l+yr(f)),p=Z.BASE.multiplyAndAddUnsafe(d,u,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return Je(this.toHex(e))}toHex(e=!1){let r=yr(this.x);return e?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${yr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!_s(r)||!_s(n))throw new Error(e);let i=R(n*n),s=ef(r);if(R(i-s)!==q)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Z(this.x,R(-this.y))}double(){return W.fromAffine(this).double().toAffine()}add(e){return W.fromAffine(this).add(W.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return W.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=W.fromAffine(this),s=r===q||r===it||this!==Z.BASE?i.multiplyUnsafe(r):i.multiply(r),a=W.fromAffine(e).multiplyUnsafe(n),o=s.add(a);return o.equals(W.ZERO)?void 0:o.toAffine()}};Z.BASE=new Z(ht.Gx,ht.Gy);Z.ZERO=new Z(q,q);function nf(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function sf(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${xr(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:ke(r),left:t.subarray(e+2)}}function Op(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${xr(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=sf(t.subarray(2)),{data:n,left:i}=sf(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${xr(i)}`);return{r:e,s:n}}var ce=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?xr(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new ce(jn(i.slice(0,64)),jn(i.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=Op(r?e:Je(e));return new ce(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!Yr(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Yr(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=ht.n>>it;return this.s>e}normalizeS(){return this.hasHighS()?new ce(this.r,R(-this.s,ht.n)):this}toDERRawBytes(){return Je(this.toDERHex())}toDERHex(){let e=nf(Wr(this.s)),r=nf(Wr(this.r)),n=e.length/2,i=r.length/2,s=Wr(n),a=Wr(i);return`30${Wr(i+n+4)}02${a}${r}02${s}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Je(this.toCompactHex())}toCompactHex(){return yr(this.r)+yr(this.s)}};function De(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}var Fp=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function xr(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=Fp[t[r]];return e}var Vp=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function yr(t){if(typeof t!="bigint")throw new Error("Expected bigint");if(!(q<=t&&t<Vp))throw new Error("Expected number 0 <= n < 2^256");return t.toString(16).padStart(64,"0")}function Ns(t){let e=Je(yr(t));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function Wr(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function jn(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function Je(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function ke(t){return jn(xr(t))}function vr(t){return t instanceof Uint8Array?Uint8Array.from(t):Je(t)}function af(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&Yr(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function R(t,e=ht.P){let r=t%e;return r>=q?r:e+r}function Vt(t,e){let{P:r}=ht,n=t;for(;e-- >q;)n*=n,n%=r;return n}function qp(t){let{P:e}=ht,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),o=BigInt(88),f=t*t*t%e,c=f*f*t%e,u=Vt(c,$r)*c%e,h=Vt(u,$r)*c%e,l=Vt(h,Le)*f%e,d=Vt(l,n)*l%e,p=Vt(d,i)*d%e,g=Vt(p,a)*p%e,x=Vt(g,o)*g%e,v=Vt(x,a)*p%e,B=Vt(v,$r)*c%e,A=Vt(B,s)*d%e,L=Vt(A,r)*f%e,T=Vt(L,Le);if(T*T%e!==t)throw new Error("Cannot find square root");return T}function br(t,e=ht.P){if(t===q||e<=q)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=R(t,e),n=e,i=q,s=it,a=it,o=q;for(;r!==q;){let c=n/r,u=n%r,h=i-a*c,l=s-o*c;n=r,r=u,i=a,s=o,a=h,o=l}if(n!==it)throw new Error("invert: does not exist");return R(i,e)}function zp(t,e=ht.P){let r=new Array(t.length),n=t.reduce((s,a,o)=>a===q?s:(r[o]=s,R(s*a,e)),it),i=br(n,e);return t.reduceRight((s,a,o)=>a===q?s:(r[o]=R(s*r[o],e),R(s*a,e)),i),r}function Hp(t){let e=t.length*8-mr*8,r=ke(t);return e>0?r>>BigInt(e):r}function Ls(t,e=!1){let r=Hp(t);if(e)return r;let{n}=ht;return r>=n?r-n:r}var gr,Zr,Ds=class{constructor(e,r){if(this.hashLen=e,this.qByteLen=r,typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(e).fill(1),this.k=new Uint8Array(e).fill(0),this.counter=0}hmac(...e){return Qt.hmacSha256(this.k,...e)}hmacSync(...e){return Zr(this.k,...e)}checkSync(){if(typeof Zr!="function")throw new Jn("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return De(...r)}generateSync(){this.checkSync(),this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return De(...r)}};function Yr(t){return q<t&&t<ht.n}function _s(t){return q<t&&t<ht.P}function Gp(t,e,r,n=!0){let{n:i}=ht,s=Ls(t,!0);if(!Yr(s))return;let a=br(s,i),o=Z.BASE.multiply(s),f=R(o.x,i);if(f===q)return;let c=R(a*R(e+r*f,i),i);if(c===q)return;let u=new ce(f,c),h=(o.x===u.r?0:2)|Number(o.y&it);return n&&u.hasHighS()&&(u=u.normalizeS(),h^=1),{sig:u,recovery:h}}function ti(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==2*mr)throw new Error("Expected 32 bytes of private key");e=jn(t)}else if(t instanceof Uint8Array){if(t.length!==mr)throw new Error("Expected 32 bytes of private key");e=ke(t)}else throw new TypeError("Expected valid private key");if(!Yr(e))throw new Error("Expected private key: 0 < key < n");return e}function Wp(t){return t instanceof Z?(t.assertValidity(),t):Z.fromHex(t)}function of(t){if(t instanceof ce)return t.assertValidity(),t;try{return ce.fromDER(t)}catch{return ce.fromCompact(t)}}function ks(t,e=!1){return Z.fromPrivateKey(t).toRawBytes(e)}function ff(t){let e=t.length>Yt?t.slice(0,Yt):t;return ke(e)}function $p(t){let e=ff(t),r=R(e,ht.n);return cf(r<q?e:r)}function cf(t){return Ns(t)}function Zp(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=vr(t),i=ti(e),s=[cf(i),$p(n)];if(r!=null){r===!0&&(r=Qt.randomBytes(Yt));let f=vr(r);if(f.length!==Yt)throw new Error(`sign: Expected ${Yt} bytes of extra data`);s.push(f)}let a=De(...s),o=ff(n);return{seed:a,m:o,d:i}}function Yp(t,e){let{sig:r,recovery:n}=t,{der:i,recovered:s}=Object.assign({canonical:!0,der:!0},e),a=i?r.toDERRawBytes():r.toCompactRawBytes();return s?[a,n]:a}async function uf(t,e,r={}){let{seed:n,m:i,d:s}=Zp(t,e,r.extraEntropy),a=new Ds(Mp,mr);await a.reseed(n);let o;for(;!(o=Gp(await a.generate(),i,s,r.canonical));)await a.reseed();return Yp(o,r)}var Qp={strict:!0};function hf(t,e,r,n=Qp){let i;try{i=of(t),e=vr(e)}catch{return!1}let{r:s,s:a}=i;if(n.strict&&i.hasHighS())return!1;let o=Ls(e),f;try{f=Wp(r)}catch{return!1}let{n:c}=ht,u=br(a,c),h=R(o*u,c),l=R(s*u,c),d=Z.BASE.multiplyAndAddUnsafe(f,h,l);return d?R(d.x,c)===s:!1}Z.BASE._setWindowSize(8);var Ut={node:Kp,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Xn={},Qt={bytesToHex:xr,hexToBytes:Je,concatBytes:De,mod:R,invert:br,isValidPrivateKey(t){try{return ti(t),!0}catch{return!1}},_bigintTo32Bytes:Ns,_normalizePrivateKey:ti,hashToPrivateKey:t=>{t=vr(t);let e=mr+8;if(t.length<e||t.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=R(ke(t),ht.n-it)+it;return Ns(r)},randomBytes:(t=32)=>{if(Ut.web)return Ut.web.getRandomValues(new Uint8Array(t));if(Ut.node){let{randomBytes:e}=Ut.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Qt.hashToPrivateKey(Qt.randomBytes(mr+8)),precompute(t=8,e=Z.BASE){let r=e===Z.BASE?e:new Z(e.x,e.y);return r._setWindowSize(t),r.multiply($r),r},sha256:async(...t)=>{if(Ut.web){let e=await Ut.web.subtle.digest("SHA-256",De(...t));return new Uint8Array(e)}else if(Ut.node){let{createHash:e}=Ut.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(Ut.web){let r=await Ut.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=De(...e),i=await Ut.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Ut.node){let{createHmac:r}=Ut.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=Xn[t];if(r===void 0){let n=await Qt.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=De(n,n),Xn[t]=r}return Qt.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof gr!="function")throw new Jn("sha256Sync is undefined, you need to set it");let r=Xn[t];if(r===void 0){let n=gr(Uint8Array.from(t,i=>i.charCodeAt(0)));r=De(n,n),Xn[t]=r}return gr(r,...e)},_JacobianPoint:W};Object.defineProperties(Qt,{sha256Sync:{configurable:!1,get(){return gr},set(t){gr||(gr=t)}},hmacSha256Sync:{configurable:!1,get(){return Zr},set(t){Zr||(Zr=t)}}});function ei(t){if(isNaN(t)||t<=0)throw new Y("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Qt.randomBytes(t)}var je={};Bt(je,{jwkToPkcs1:()=>jp,jwkToPkix:()=>ed,pkcs1ToJwk:()=>Jp,pkixToJwk:()=>td});var dg=X(qr(),1),yg=X($n(),1),ve=X(J(),1);function Jp(t){let e=ve.default.asn1.fromDer(tt(t,"ascii")),r=ve.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Zt(r.n),e:Zt(r.e),d:Zt(r.d),p:Zt(r.p),q:Zt(r.q),dp:Zt(r.dP),dq:Zt(r.dQ),qi:Zt(r.qInv),alg:"RS256"}}function jp(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new Y("JWK was missing components","ERR_INVALID_PARAMETERS");let e=ve.default.pki.privateKeyToAsn1({n:Pt(t.n),e:Pt(t.e),d:Pt(t.d),p:Pt(t.p),q:Pt(t.q),dP:Pt(t.dp),dQ:Pt(t.dq),qInv:Pt(t.qi)});return Ct(ve.default.asn1.toDer(e).getBytes(),"ascii")}function td(t){let e=ve.default.asn1.fromDer(tt(t,"ascii")),r=ve.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Zt(r.n),e:Zt(r.e)}}function ed(t){if(t.n==null||t.e==null)throw new Y("JWK was missing components","ERR_INVALID_PARAMETERS");let e=ve.default.pki.publicKeyToAsn1({n:Pt(t.n),e:Pt(t.e)});return Ct(ve.default.asn1.toDer(e).getBytes(),"ascii")}var bg=X($n(),1),Ps=X(J(),1);function lf(t,e){return e.map(r=>Pt(t[r]))}function pf(t){return Ps.default.pki.setRsaPrivateKey(...lf(t,["n","e","d","p","q","dp","dq","qi"]))}function df(t){return Ps.default.pki.setRsaPublicKey(...lf(t,["n","e"]))}async function yf(t){let e=await Dt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await xf(e);return{privateKey:r[0],publicKey:r[1]}}async function Us(t){let r=[await Dt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await rd(t)],n=await xf({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function gf(t,e){let r=await Dt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Dt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function mf(t,e,r){let n=await Dt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await Dt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function xf(t){if(t.privateKey==null||t.publicKey==null)throw new Y("Private and public key are required","ERR_INVALID_PARAMETERS");return await Promise.all([Dt.get().subtle.exportKey("jwk",t.privateKey),Dt.get().subtle.exportKey("jwk",t.publicKey)])}async function rd(t){return await Dt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function vf(t,e,r,n){let i=e?df(t):pf(t),s=tt(Uint8Array.from(r),"ascii"),a=n(s,i);return Ct(a,"ascii")}function bf(t,e){return vf(t,!0,e,(r,n)=>n.encrypt(r))}function wf(t,e){return vf(t,!1,e,(r,n)=>n.decrypt(r))}async function wr(t,e){let n=await Cs().encrypt(t,e);return mn.encode(n)}var Xr=class{constructor(e){this._key=e}async verify(e,r){return await mf(this._key,r,e)}marshal(){return je.jwkToPkix(this._key)}get bytes(){return ee.encode({Type:at.RSA,Data:this.marshal()}).subarray()}encrypt(e){return bf(this._key,e)}equals(e){return gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}},Sr=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return ei(16)}async sign(e){return await gf(this._key,e)}get public(){if(this._publicKey==null)throw new Y("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Xr(this._publicKey)}decrypt(e){return wf(this._key,e)}marshal(){return je.jwkToPkcs1(this._key)}get bytes(){return re.encode({Type:at.RSA,Data:this.marshal()}).subarray()}equals(e){return gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}async id(){let e=await this.public.hash();return tt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Qr.default.util.ByteBuffer(this.marshal()),i=Qr.default.asn1.fromDer(n),s=Qr.default.pki.privateKeyFromAsn1(i),a={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Qr.default.pki.encryptRsaPrivateKey(s,e,a)}else{if(r==="libp2p-key")return await wr(this.bytes,e);throw new Y(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function id(t){let e=je.pkcs1ToJwk(t),r=await Us(e);return new Sr(r.privateKey,r.publicKey)}function sd(t){let e=je.pkixToJwk(t);return new Xr(e)}async function ad(t){let e=await Us(t);return new Sr(e.privateKey,e.publicKey)}async function od(t){let e=await yf(t);return new Sr(e.privateKey,e.publicKey)}var Ws={};Bt(Ws,{Ed25519PrivateKey:()=>er,Ed25519PublicKey:()=>rn,generateKeyPair:()=>Id,generateKeyPairFromSeed:()=>Uf,unmarshalEd25519PrivateKey:()=>Cd,unmarshalEd25519PublicKey:()=>Td});var fd=X(lr(),1);var St=BigInt(0),z=BigInt(1),Ke=BigInt(2),cd=BigInt(8),Sf=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),st=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:Sf,n:Sf,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var Tf=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Jr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Kg=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),ud=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),hd=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),ld=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),pd=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),O=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof ft))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(ft.ZERO)?O.ZERO:new O(e.x,e.y,z,S(e.x*e.y))}static toAffineBatch(e){let r=gd(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){Bf(e);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=e,f=S(r*o),c=S(s*i),u=S(n*o),h=S(a*i);return f===c&&u===h}negate(){return new O(S(-this.x),this.y,this.z,S(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=st,s=S(e*e),a=S(r*r),o=S(Ke*S(n*n)),f=S(i*s),c=e+r,u=S(S(c*c)-s-a),h=f+a,l=h-o,d=f-a,p=S(u*l),g=S(h*d),x=S(u*d),v=S(l*h);return new O(p,g,v,x)}add(e){Bf(e);let{x:r,y:n,z:i,t:s}=this,{x:a,y:o,z:f,t:c}=e,u=S((n-r)*(o+a)),h=S((n+r)*(o-a)),l=S(h-u);if(l===St)return this.double();let d=S(i*Ke*c),p=S(s*Ke*f),g=p+d,x=h+u,v=p-d,B=S(g*l),A=S(x*v),L=S(g*v),T=S(l*x);return new O(B,A,T,L)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,s=i;for(let a=0;a<r;a++){s=i,n.push(s);for(let o=1;o<2**(e-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(O.BASE)&&(r=ft.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&qs.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=O.normalizeZ(i),qs.set(r,i)));let s=O.ZERO,a=O.BASE,o=1+256/n,f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(e&c);e>>=h,p>f&&(p-=u,e+=z);let g=d,x=d+Math.abs(p)-1,v=l%2!==0,B=p<0;p===0?a=a.add(Ef(v,i[g])):s=s.add(Ef(B,i[x]))}return O.normalizeZ([s,a])[0]}multiply(e,r){return this.wNAF(ni(e,st.l),r)}multiplyUnsafe(e){let r=ni(e,st.l,!1),n=O.BASE,i=O.ZERO;if(r===St)return i;if(this.equals(i)||r===z)return this;if(this.equals(n))return this.wNAF(r);let s=i,a=this;for(;r>St;)r&z&&(s=s.add(a)),a=a.double(),r>>=z;return s}isSmallOrder(){return this.multiplyUnsafe(st.h).equals(O.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(st.l/Ke).double();return st.l%Ke&&(e=e.add(this)),e.equals(O.ZERO)}toAffine(e){let{x:r,y:n,z:i}=this,s=this.equals(O.ZERO);e==null&&(e=s?cd:ii(i));let a=S(r*e),o=S(n*e),f=S(i*e);if(s)return ft.ZERO;if(f!==z)throw new Error("invZ was invalid");return new ft(a,o)}fromRistrettoBytes(){Os()}toRistrettoBytes(){Os()}fromRistrettoHash(){Os()}};O.BASE=new O(st.Gx,st.Gy,z,S(st.Gx*st.Gy));O.ZERO=new O(St,z,z,St);function Ef(t,e){let r=e.negate();return t?r:e}function Bf(t){if(!(t instanceof O))throw new TypeError("ExtendedPoint expected")}function Ms(t){if(!(t instanceof Lt))throw new TypeError("RistrettoPoint expected")}function Os(){throw new Error("Legacy method: switch to RistrettoPoint")}var Lt=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=st,n=S(Jr*e*e),i=S((n+z)*ld),s=BigInt(-1),a=S((s-r*n)*S(n+r)),{isValid:o,value:f}=Hs(i,a),c=S(f*e);Ue(c)||(c=S(-c)),o||(f=c),o||(s=n);let u=S(s*(n-z)*pd-a),h=f*f,l=S((f+f)*a),d=S(u*ud),p=S(z-h),g=S(z+h);return new O(S(l*g),S(p*d),S(d*g),S(l*p))}static hashToCurve(e){e=Me(e,64);let r=Fs(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=Fs(e.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new Lt(n.add(s))}static fromHex(e){e=Me(e,32);let{a:r,d:n}=st,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=Fs(e);if(!xd(jr(s),e)||Ue(s))throw new Error(i);let a=S(s*s),o=S(z+r*a),f=S(z-r*a),c=S(o*o),u=S(f*f),h=S(r*n*c-u),{isValid:l,value:d}=Cf(S(h*u)),p=S(d*f),g=S(d*p*h),x=S((s+s)*p);Ue(x)&&(x=S(-x));let v=S(o*g),B=S(x*v);if(!l||Ue(B)||v===St)throw new Error(i);return new Lt(new O(x,v,z,B))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,s=S(S(n+r)*S(n-r)),a=S(e*r),o=S(a*a),{value:f}=Cf(S(s*o)),c=S(f*s),u=S(f*a),h=S(c*u*i),l;if(Ue(i*h)){let p=S(r*Jr),g=S(e*Jr);e=p,r=g,l=S(c*hd)}else l=u;Ue(e*h)&&(r=S(-r));let d=S((n-r)*l);return Ue(d)&&(d=S(-d)),jr(d)}toHex(){return tn(this.toRawBytes())}toString(){return this.toHex()}equals(e){Ms(e);let r=this.ep,n=e.ep,i=S(r.x*n.y)===S(r.y*n.x),s=S(r.y*n.y)===S(r.x*n.x);return i||s}add(e){return Ms(e),new Lt(this.ep.add(e.ep))}subtract(e){return Ms(e),new Lt(this.ep.subtract(e.ep))}multiply(e){return new Lt(this.ep.multiply(e))}multiplyUnsafe(e){return new Lt(this.ep.multiplyUnsafe(e))}};Lt.BASE=new Lt(O.BASE);Lt.ZERO=new Lt(O.ZERO);var qs=new WeakMap,ft=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,qs.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=st;e=Me(e,32);let s=e.slice();s[31]=e[31]&-129;let a=en(s);if(r&&a>=i)throw new Error("Expected 0 < hex < P");if(!r&&a>=Tf)throw new Error("Expected 0 < hex < 2**256");let o=S(a*a),f=S(o-z),c=S(n*o+z),{isValid:u,value:h}=Hs(f,c);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&z)===z;return(e[31]&128)!==0!==l&&(h=S(-h)),new ft(h,a)}static async fromPrivateKey(e){return(await si(e)).point}toRawBytes(){let e=jr(this.y);return e[31]|=this.x&z?128:0,e}toHex(){return tn(this.toRawBytes())}toX25519(){let{y:e}=this,r=S((z+e)*ii(z-e));return jr(r)}isTorsionFree(){return O.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new ft(S(-this.x),this.y)}add(e){return O.fromAffine(this).add(O.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return O.fromAffine(this).multiply(e,this).toAffine()}};ft.BASE=new ft(st.Gx,st.Gy);ft.ZERO=new ft(St,z);var tr=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=Me(e,64),n=ft.fromHex(r.slice(0,32),!1),i=en(r.slice(32,64));return new tr(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof ft))throw new Error("Expected Point instance");return ni(r,st.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(jr(this.s),32),e}toHex(){return tn(this.toRawBytes())}};function Af(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}var dd=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function tn(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=dd[t[r]];return e}function zs(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function If(t){let r=t.toString(16).padStart(64,"0");return zs(r)}function jr(t){return If(t).reverse()}function Ue(t){return(S(t)&z)===z}function en(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+tn(Uint8Array.from(t).reverse()))}var yd=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Fs(t){return S(en(t)&yd)}function S(t,e=st.P){let r=t%e;return r>=St?r:e+r}function ii(t,e=st.P){if(t===St||e<=St)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=S(t,e),n=e,i=St,s=z,a=z,o=St;for(;r!==St;){let c=n/r,u=n%r,h=i-a*c,l=s-o*c;n=r,r=u,i=a,s=o,a=h,o=l}if(n!==z)throw new Error("invert: does not exist");return S(i,e)}function gd(t,e=st.P){let r=new Array(t.length),n=t.reduce((s,a,o)=>a===St?s:(r[o]=s,S(s*a,e)),z),i=ii(n,e);return t.reduceRight((s,a,o)=>a===St?s:(r[o]=S(s*r[o],e),S(s*a,e)),i),r}function ue(t,e){let{P:r}=st,n=t;for(;e-- >St;)n*=n,n%=r;return n}function md(t){let{P:e}=st,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),a=BigInt(80),f=t*t%e*t%e,c=ue(f,Ke)*f%e,u=ue(c,z)*t%e,h=ue(u,r)*u%e,l=ue(h,n)*h%e,d=ue(l,i)*l%e,p=ue(d,s)*d%e,g=ue(p,a)*p%e,x=ue(g,a)*p%e,v=ue(x,n)*h%e;return{pow_p_5_8:ue(v,Ke)*t%e,b2:f}}function Hs(t,e){let r=S(e*e*e),n=S(r*r*e),i=md(t*n).pow_p_5_8,s=S(t*r*i),a=S(e*s*s),o=s,f=S(s*Jr),c=a===t,u=a===S(-t),h=a===S(-t*Jr);return c&&(s=o),(u||h)&&(s=f),Ue(s)&&(s=S(-s)),{isValid:c||u,value:s}}function Cf(t){return Hs(z,t)}function ri(t){return S(en(t),st.l)}function xd(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Me(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):zs(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function ni(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(St<t)return t}else if(St<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function vd(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function bd(t){if(t=typeof t=="bigint"||typeof t=="number"?If(ni(t,Tf)):Me(t),t.length!==32)throw new Error("Expected 32 bytes");return t}function wd(t){let e=vd(t.slice(0,32)),r=t.slice(32,64),n=ri(e),i=ft.BASE.multiply(n),s=i.toRawBytes();return{head:e,prefix:r,scalar:n,point:i,pointBytes:s}}var Vs;async function si(t){return wd(await Oe.sha512(bd(t)))}async function Gs(t){return(await si(t)).pointBytes}async function _f(t,e){t=Me(t);let{prefix:r,scalar:n,pointBytes:i}=await si(e),s=ri(await Oe.sha512(r,t)),a=ft.BASE.multiply(s),o=ri(await Oe.sha512(a.toRawBytes(),i,t)),f=S(s+o*n,st.l);return new tr(a,f).toRawBytes()}function Sd(t,e,r){e=Me(e),r instanceof ft||(r=ft.fromHex(r,!1));let{r:n,s:i}=t instanceof tr?t.assertValidity():tr.fromHex(t),s=O.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:s,pub:r,msg:e}}function Ed(t,e,r,n){let i=ri(n),s=O.fromAffine(t).multiplyUnsafe(i);return O.fromAffine(e).add(s).subtract(r).multiplyUnsafe(st.h).equals(O.ZERO)}async function Rf(t,e,r){let{r:n,SB:i,msg:s,pub:a}=Sd(t,e,r),o=await Oe.sha512(n.toRawBytes(),a.toRawBytes(),s);return Ed(a,n,i,o)}ft.BASE._setWindowSize(8);var Pe={node:fd,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Oe={bytesToHex:tn,hexToBytes:zs,concatBytes:Af,getExtendedPublicKey:si,mod:S,invert:ii,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if(t=Me(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return S(en(t),st.l-z)+z},randomBytes:(t=32)=>{if(Pe.web)return Pe.web.getRandomValues(new Uint8Array(t));if(Pe.node){let{randomBytes:e}=Pe.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Oe.randomBytes(32),sha512:async(...t)=>{let e=Af(...t);if(Pe.web){let r=await Pe.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(r)}else{if(Pe.node)return Uint8Array.from(Pe.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=ft.BASE){let r=e.equals(ft.BASE)?e:new ft(e.x,e.y);return r._setWindowSize(t),r.multiply(Ke),r},sha512Sync:void 0};Object.defineProperties(Oe,{sha512Sync:{configurable:!1,get(){return Vs},set(t){Vs||(Vs=t)}}});var Er=32,be=64,ai=32;async function Nf(){let t=Oe.randomPrivateKey(),e=await Gs(t);return{privateKey:Pf(t,e),publicKey:e}}async function Df(t){if(t.length!==ai)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await Gs(e);return{privateKey:Pf(e,r),publicKey:r}}async function Lf(t,e){let r=t.subarray(0,ai);return await _f(e,r)}async function kf(t,e,r){return await Rf(e,r,t)}function Pf(t,e){let r=new Uint8Array(be);for(let n=0;n<ai;n++)r[n]=t[n],r[ai+n]=e[n];return r}var rn=class{constructor(e){this._key=Br(e,Er)}async verify(e,r){return await kf(this._key,r,e)}marshal(){return this._key}get bytes(){return ee.encode({Type:at.Ed25519,Data:this.marshal()}).subarray()}equals(e){return gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}},er=class{constructor(e,r){this._key=Br(e,be),this._publicKey=Br(r,Er)}async sign(e){return await Lf(this._key,e)}get public(){return new rn(this._publicKey)}marshal(){return this._key}get bytes(){return re.encode({Type:at.Ed25519,Data:this.marshal()}).subarray()}equals(e){return gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}async id(){let e=await Ee.digest(this.public.bytes);return yt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await wr(this.bytes,e);throw new Y(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Cd(t){if(t.length>be){t=Br(t,be+Er);let n=t.subarray(0,be),i=t.subarray(be,t.length);return new er(n,i)}t=Br(t,be);let e=t.subarray(0,be),r=t.subarray(Er);return new er(e,r)}function Td(t){return t=Br(t,Er),new rn(t)}async function Id(){let{privateKey:t,publicKey:e}=await Nf();return new er(t,e)}async function Uf(t){let{privateKey:e,publicKey:r}=await Df(t);return new er(e,r)}function Br(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new Y(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var Zs={};Bt(Zs,{Secp256k1PrivateKey:()=>sn,Secp256k1PublicKey:()=>nn,generateKeyPair:()=>Dd,unmarshalSecp256k1PrivateKey:()=>Rd,unmarshalSecp256k1PublicKey:()=>Nd});function Kf(){return Qt.randomPrivateKey()}async function Mf(t,e){let{digest:r}=await At.digest(e);try{return await uf(r,t)}catch(n){throw new Y(String(n),"ERR_INVALID_INPUT")}}async function Of(t,e,r){try{let{digest:n}=await At.digest(r);return hf(e,n,t)}catch(n){throw new Y(String(n),"ERR_INVALID_INPUT")}}function Ff(t){return Z.fromHex(t).toRawBytes(!0)}function Vf(t){try{ks(t,!0)}catch(e){throw new Y(String(e),"ERR_INVALID_PRIVATE_KEY")}}function $s(t){try{Z.fromHex(t)}catch(e){throw new Y(String(e),"ERR_INVALID_PUBLIC_KEY")}}function qf(t){try{return ks(t,!0)}catch(e){throw new Y(String(e),"ERR_INVALID_PRIVATE_KEY")}}var nn=class{constructor(e){$s(e),this._key=e}async verify(e,r){return await Of(this._key,r,e)}marshal(){return Ff(this._key)}get bytes(){return ee.encode({Type:at.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}},sn=class{constructor(e,r){this._key=e,this._publicKey=r??qf(e),Vf(this._key),$s(this._publicKey)}async sign(e){return await Mf(this._key,e)}get public(){return new nn(this._publicKey)}marshal(){return this._key}get bytes(){return re.encode({Type:at.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await At.digest(this.bytes);return e}async id(){let e=await this.public.hash();return tt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await wr(this.bytes,e);throw new Y(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Rd(t){return new sn(t)}function Nd(t){return new nn(t)}async function Dd(){let t=await Kf();return new sn(t)}var rr={rsa:Ks,ed25519:Ws,secp256k1:Zs};function zf(t){let e=Object.keys(rr).join(" / ");return new Y(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Hf(t){let e=ee.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case at.RSA:return rr.rsa.unmarshalRsaPublicKey(r);case at.Ed25519:return rr.ed25519.unmarshalEd25519PublicKey(r);case at.Secp256k1:return rr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw zf(e.Type??"RSA")}}async function Gf(t){let e=re.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case at.RSA:return await rr.rsa.unmarshalRsaPrivateKey(r);case at.Ed25519:return rr.ed25519.unmarshalEd25519PrivateKey(r);case at.Secp256k1:return rr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw zf(e.Type??"RSA")}}var Wf={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var Ys=X(En(),1),$f=X(Hi(),1),Zf=X(Ce(),1),Qs=X(An(),1),Yf=X(Xi(),1);function kd(){Zf.default._configure(),Ys.default._configure($f.default),Qs.default._configure(Yf.default)}kd();var Qf=["uint64","int64","sint64","fixed64","sfixed64"];function Pd(t){for(let e of Qf){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function Xs(t){return Pd(new Ys.default(t))}function Ud(t){for(let e of Qf){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function Js(){return Ud(Qs.default.create())}function Ar(t,e){let r=Xs(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function Cr(t,e){let r=Js();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var an;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(an||(an={}));function js(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Tr(t,e){return js("message",an.LENGTH_DELIMITED,t,e)}var on;(function(t){let e;t.codec=()=>(e==null&&(e=Tr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.publicKey!=null&&r.publicKey.byteLength>0&&(n.uint32(10),n.bytes(r.publicKey)),r.payloadType!=null&&r.payloadType.byteLength>0&&(n.uint32(18),n.bytes(r.payloadType)),r.payload!=null&&r.payload.byteLength>0&&(n.uint32(26),n.bytes(r.payload)),r.signature!=null&&r.signature.byteLength>0&&(n.uint32(42),n.bytes(r.signature)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.publicKey=r.bytes();break;case 2:i.payloadType=r.bytes();break;case 3:i.payload=r.bytes();break;case 5:i.signature=r.bytes();break;default:r.skipType(a&7);break}}return i})),e),t.encode=r=>Cr(r,t.codec()),t.decode=r=>Ar(r,t.codec())})(on||(on={}));var Xf=Symbol.for("@libp2p/peer-id");var Kd=Symbol.for("nodejs.util.inspect.custom"),Jf=Object.values(Be).map(t=>t.decoder).reduce((t,e)=>t.or(e),Be.identity.decoder),jf=114,ta=36,ea=37,fn=class{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[Xf](){return!0}toString(){return this.string==null&&(this.string=yt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return j.createV1(jf,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return gt(this.multihash.bytes,e);if(typeof e=="string")return Md(e).equals(this);if(e?.multihash?.bytes!=null)return gt(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Kd](){return`PeerId(${this.toString()})`}},Ir=class extends fn{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}},_r=class extends fn{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}},Rr=class extends fn{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}};function Md(t,e){if(e=e??Jf,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Ve(yt.decode(`z${t}`));return t.startsWith("12D")?new _r({multihash:r}):t.startsWith("16U")?new Rr({multihash:r}):new Ir({multihash:r})}return ra(Jf.decode(t))}function ra(t){try{let e=Ve(t);if(e.code===Ee.code){if(e.digest.length===ta)return new _r({multihash:e});if(e.digest.length===ea)return new Rr({multihash:e})}if(e.code===At.code)return new Ir({multihash:e})}catch{return Od(j.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function Od(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==jf)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===At.code)return new Ir({multihash:t.multihash});if(e.code===Ee.code){if(e.digest.length===ta)return new _r({multihash:t.multihash});if(e.digest.length===ea)return new Rr({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function tc(t,e){return t.length===ta?new _r({multihash:Jt(Ee.code,t),privateKey:e}):t.length===ea?new Rr({multihash:Jt(Ee.code,t),privateKey:e}):new Ir({multihash:await At.digest(t),publicKey:t,privateKey:e})}var rc=Symbol.for("@achingbrain/uint8arraylist");function ec(t,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let r=0;for(let n of t){let i=r+n.byteLength;if(e<i)return{buf:n,index:e-r};r=i}throw new RangeError("index is out of bounds")}function oi(t){return!!t?.[rc]}var Fe=class{constructor(...e){Object.defineProperty(this,rc,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(oi(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...e){this.prependAll(e)}prependAll(e){let r=0;for(let n of e.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(oi(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=ec(this.bufs,e);return r.buf[r.index]}set(e,r){let n=ec(this.bufs,e);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(oi(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return mt(n,i)}subarray(e,r){let{bufs:n,length:i}=this._subList(e,r);return n.length===1?n[0]:mt(n,i)}sublist(e,r){let{bufs:n,length:i}=this._subList(e,r),s=new Fe;return s.length=i,s.bufs=n,s}_subList(e,r){if(e=e??0,r=r??this.length,e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index is out of bounds");if(e===r)return{bufs:[],length:0};if(e===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let a=this.bufs[s],o=i,f=o+a.byteLength;if(i=f,e>=f)continue;let c=e>=o&&e<f,u=r>o&&r<=f;if(c&&u){if(e===o&&r===f){n.push(a);break}let h=e-o;n.push(a.subarray(h,h+(r-e)));break}if(c){if(e===0){n.push(a);continue}n.push(a.subarray(e-o));continue}if(u){if(r===f){n.push(a);break}n.push(a.subarray(0,r-o));break}n.push(a)}return{bufs:n,length:r-e}}indexOf(e,r=0){if(!oi(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),e.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let s=256,a=new Int32Array(s);for(let h=0;h<s;h++)a[h]=-1;for(let h=0;h<i;h++)a[n[h]]=h;let o=a,f=this.byteLength-n.byteLength,c=n.byteLength-1,u;for(let h=r;h<=f;h+=u){u=0;for(let l=c;l>=0;l--){let d=this.get(h+l);if(n[l]!==d){u=Math.max(1,l-o[d]);break}}if(u===0)return h}return-1}getInt8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=ye(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=de(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=de(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=de(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=ye(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=de(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=de(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=de(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=de(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=de(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}equals(e){if(e==null||!(e instanceof Fe)||e.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!gt(this.bufs[r],e.bufs[r]))return!1;return!0}static fromUint8Arrays(e,r){let n=new Fe;return n.bufs=e,r==null&&(r=e.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};function fi(t){return t instanceof Uint8Array?{get(e){return t[e]},set(e,r){t[e]=r}}:{get(e){return t.get(e)},set(e,r){t.set(e,r)}}}var nc=4294967296,Kt=class{constructor(e=0,r=0){this.hi=e,this.lo=r}toBigInt(e){if(e===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){let e=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new Kt(n,r)}zzEncode(){let e=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new Kt(r,n)}toBytes(e,r=0){let n=fi(e);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(e){if(e===0n)return new Kt;let r=e<0;r&&(e=-e);let n=Number(e>>32n)|0,i=Number(e-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>nc&&(i=0,++n>nc&&(n=0))),new Kt(n,i)}static fromNumber(e){if(e===0)return new Kt;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Kt(i,n)}static fromBytes(e,r=0){let n=fi(e),i=new Kt,s=0;if(e.length-r>4){for(;s<4;++s)if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;s=0}else for(;s<4;++s){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i}if(e.length-r>4){for(;s<5;++s)if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}else if(r<e.byteLength)for(;s<5;++s){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};var Fd=Math.pow(2,7),Vd=Math.pow(2,14),qd=Math.pow(2,21),zd=Math.pow(2,28),Hd=Math.pow(2,35),Gd=Math.pow(2,42),Wd=Math.pow(2,49),$d=Math.pow(2,56),Zd=Math.pow(2,63),cn={encodingLength(t){return t<Fd?1:t<Vd?2:t<qd?3:t<zd?4:t<Hd?5:t<Gd?6:t<Wd?7:t<$d?8:t<Zd?9:10},encode(t,e,r=0){if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return e==null&&(e=ye(cn.encodingLength(t))),Kt.fromNumber(t).toBytes(e,r),e},decode(t,e=0){return Kt.fromBytes(t,e).toNumber(!0)}};var Yd,Xt=class{constructor(e){let{peerId:r,payloadType:n,payload:i,signature:s}=e;this.peerId=r,this.payloadType=n,this.payload=i,this.signature=s}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=on.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return gt(this.marshal(),e.marshal())}async validate(e){let r=ic(e,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return await Hf(this.peerId.publicKey).verify(r.subarray(),this.signature)}};Yd=Xt;Xt.createFromProtobuf=async t=>{let e=on.decode(t),r=await tc(e.publicKey);return new Xt({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};Xt.seal=async(t,e)=>{if(e.privateKey==null)throw new Error("Missing private key");let r=t.domain,n=t.codec,i=t.marshal(),s=ic(r,n,i),o=await(await Gf(e.privateKey)).sign(s.subarray());return new Xt({peerId:e,payloadType:n,payload:i,signature:o})};Xt.openAndCertify=async(t,e)=>{let r=await Xt.createFromProtobuf(t);if(!await r.validate(e))throw new Y("envelope signature is not valid for the given domain",Wf.ERR_SIGNATURE_NOT_VALID);return r};var ic=(t,e,r)=>{let n=Ct(t),i=cn.encode(n.byteLength),s=cn.encode(e.length),a=cn.encode(r.length);return new Fe(i,n,s,e,a,r)};var ci=class{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){let r=this.index,n=e();return n===void 0&&(this.index=r),n}parseWith(e){let r=e();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{let r=this.readChar();if(r===e)return r})}readSeparator(e,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(e)===void 0))return n()})}readNumber(e,r,n,i){return this.readAtomically(()=>{let s=0,a=0,o=this.peekChar();if(o===void 0)return;let f=o==="0",c=2**(8*i)-1;for(;;){let u=this.readAtomically(()=>{let h=this.readChar();if(h===void 0)return;let l=Number.parseInt(h,e);if(!Number.isNaN(l))return l});if(u===void 0)break;if(s*=e,s+=u,s>c||(a+=1,r!==void 0&&a>r))return}if(a!==0)return!n&&f&&a>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let e=new Uint8Array(4);for(let r=0;r<e.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;e[r]=n}return e})}readIPv6Addr(){let e=r=>{for(let n=0;n<r.length/2;n++){let i=n*2;if(n<r.length-3){let a=this.readSeparator(":",n,()=>this.readIPv4Addr());if(a!==void 0)return r[i]=a[0],r[i+1]=a[1],r[i+2]=a[2],r[i+3]=a[3],[i+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[i,!1];r[i]=s>>8,r[i+1]=s&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,i]=e(r);if(n===16)return r;if(i||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),a=16-(n+2),[o]=e(s.subarray(0,a));return r.set(s.subarray(0,o),16-o),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var sc=45,Qd=15,Nr=new ci;function ac(t){if(!(t.length>Qd))return Nr.new(t).parseWith(()=>Nr.readIPv4Addr())}function oc(t){if(!(t.length>sc))return Nr.new(t).parseWith(()=>Nr.readIPv6Addr())}function fc(t){if(!(t.length>sc))return Nr.new(t).parseWith(()=>Nr.readIPAddr())}function cc(t){return!!ac(t)}function uc(t){return!!oc(t)}function ui(t){return!!fc(t)}var hc=cc,Xd=uc,na=function(t){let e=0;if(t=t.toString().trim(),hc(t)){let r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(Xd(t)){let r=t.split(":",8),n;for(n=0;n<r.length;n++){let s=hc(r[n]),a;s&&(a=na(r[n]),r[n]=tt(a.slice(0,2),"base16")),a!=null&&++n<8&&r.splice(n,0,tt(a.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let i=new Uint8Array(e+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);i[e++]=s>>8&255,i[e++]=s&255}return i}throw new Error("invalid ip address")},lc=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let i=[];for(let s=0;s<r;s++)i.push(t[e+s]);return i.join(".")}if(r===16){let i=[];for(let s=0;s<r;s+=2)i.push(n.getUint16(e+s).toString(16));return i.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var un={},ia={},jd=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];jd.forEach(t=>{let e=ty(...t);ia[e.code]=e,un[e.name]=e});function ty(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:!!n,path:!!i}}function ct(t){if(typeof t=="number"){if(ia[t]!=null)return ia[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(un[t]!=null)return un[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var he=X(hi(),1);function Cc(t,e){switch(ct(t).code){case 4:case 41:return yy(e);case 42:return Bc(e);case 6:case 273:case 33:case 132:return Ic(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Bc(e);case 421:return vy(e);case 444:return Ac(e);case 445:return Ac(e);case 466:return xy(e);default:return tt(e,"base16")}}function Tc(t,e){switch(ct(t).code){case 4:return Sc(e);case 41:return Sc(e);case 42:return Ec(e);case 6:case 273:case 33:case 132:return fa(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Ec(e);case 421:return gy(e);case 444:return by(e);case 445:return wy(e);case 466:return my(e);default:return Ct(e,"base16")}}var oa=Object.values(Be).map(t=>t.decoder),dy=function(){let t=oa[0].or(oa[1]);return oa.slice(2).forEach(e=>t=t.or(e)),t}();function Sc(t){if(!ui(t))throw new Error("invalid ip address");return na(t)}function yy(t){let e=lc(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!ui(e))throw new Error("invalid ip address");return e}function fa(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function Ic(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function Ec(t){let e=Ct(t),r=Uint8Array.from(he.default.encode(e.length));return mt([r,e],r.length+e.length)}function Bc(t){let e=he.default.decode(t);if(t=t.slice(he.default.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return tt(t)}function gy(t){let e;t[0]==="Q"||t[0]==="1"?e=Ve(yt.decode(`z${t}`)).bytes:e=j.parse(t).multihash.bytes;let r=Uint8Array.from(he.default.encode(e.length));return mt([r,e],r.length+e.length)}function my(t){let e=dy.decode(t),r=Uint8Array.from(he.default.encode(e.length));return mt([r,e],r.length+e.length)}function xy(t){let e=he.default.decode(t),r=t.slice(he.default.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return"u"+tt(r,"base64url")}function vy(t){let e=he.default.decode(t),r=t.slice(he.default.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return tt(r,"base58btc")}function by(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=pe.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=fa(n);return mt([r,i],r.length+i.length)}function wy(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=pe.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=fa(n);return mt([r,i],r.length+i.length)}function Ac(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=tt(e,"base32"),i=Ic(r);return`${n}:${i}`}var Dr=X(hi(),1);function Sy(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],s=ct(i);if(s.size===0){e.push([i]);continue}if(n++,n>=r.length)throw Rc("invalid address: "+t);if(s.path===!0){e.push([i,pa(r.slice(n).join("/"))]);break}e.push([i,r[n]])}return e}function Ey(t){let e=[];return t.map(r=>{let n=di(r);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),pa(e.join("/"))}function By(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=di(e);return e.length>1?[r.code,Tc(r.code,e[1])]:[r.code]})}function ca(t){return t.map(e=>{let r=di(e);return e[1]!=null?[r.code,Cc(r.code,e[1])]:[r.code]})}function ua(t){return pi(mt(t.map(e=>{let r=di(e),n=Uint8Array.from(Dr.default.encode(r.code));return e.length>1&&e[1]!=null&&(n=mt([n,e[1]])),n})))}function ha(t,e){return t.size>0?t.size/8:t.size===0?0:Dr.default.decode(e)+(Dr.default.decode.bytes??0)}function li(t){let e=[],r=0;for(;r<t.length;){let n=Dr.default.decode(t,r),i=Dr.default.decode.bytes??0,s=ct(n),a=ha(s,t.slice(r+i));if(a===0){e.push([n]),r+=i;continue}let o=t.slice(r+i,r+i+a);if(r+=a+i,r>t.length)throw Rc("Invalid address Uint8Array: "+tt(t,"base16"));e.push([n,o])}return e}function la(t){let e=li(t),r=ca(e);return Ey(r)}function Ay(t){t=pa(t);let e=Sy(t),r=By(e);return ua(r)}function _c(t){return Ay(t)}function pi(t){let e=Cy(t);if(e!=null)throw e;return Uint8Array.from(t)}function Cy(t){try{li(t)}catch(e){return e}}function pa(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function Rc(t){return new Error("Error parsing address: "+t)}function di(t){return ct(t[0])}var ya=X(hi(),1);var Pc=X(Lc(),1);var Lr=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},da=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},hn,ln,pn,kc,_y=Symbol.for("nodejs.util.inspect.custom"),Ry=[ct("dns").code,ct("dns4").code,ct("dns6").code,ct("dnsaddr").code],Ny=new Map,Uc=Symbol.for("@multiformats/js-multiaddr/multiaddr");function Dy(t){return!!t?.[Uc]}var we=class{constructor(e){if(hn.set(this,void 0),ln.set(this,void 0),pn.set(this,void 0),this[kc]=!0,e==null&&(e=""),e instanceof Uint8Array)this.bytes=pi(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=_c(e)}else if(Dy(e))this.bytes=pi(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Lr(this,hn,"f")==null&&da(this,hn,la(this.bytes),"f"),Lr(this,hn,"f")}toJSON(){return this.toString()}toOptions(){let e,r,n,i,s="",a=ct("tcp"),o=ct("udp"),f=ct("ip4"),c=ct("ip6"),u=ct("dns6"),h=ct("ip6zone");for(let[d,p]of this.stringTuples())d===h.code&&(s=`%${p??""}`),Ry.includes(d)&&(r=a.name,i=443,n=`${p??""}${s}`,e=d===u.code?6:4),(d===a.code||d===o.code)&&(r=ct(d).name,i=parseInt(p??"")),(d===f.code||d===c.code)&&(r=ct(d).name,n=`${p??""}${s}`,e=d===c.code?6:4);if(e==null||r==null||n==null||i==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:r,port:i}}protos(){return this.protoCodes().map(e=>Object.assign({},ct(e)))}protoCodes(){let e=[],r=this.bytes,n=0;for(;n<r.length;){let i=ya.default.decode(r,n),s=ya.default.decode.bytes??0,a=ct(i),o=ha(a,r.slice(n+s));n+=o+s,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Lr(this,ln,"f")==null&&da(this,ln,li(this.bytes),"f"),Lr(this,ln,"f")}stringTuples(){return Lr(this,pn,"f")==null&&da(this,pn,ca(this.tuples()),"f"),Lr(this,pn,"f")}encapsulate(e){return e=new we(e),new we(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new we(n.slice(0,i))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new we(ua(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===un.ipfs.code).pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?tt(yt.decode(`z${n}`),"base58btc"):tt(j.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>ct(r[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return gt(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=Ny.get(r.name);if(n==null)throw(0,Pc.default)(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(s=>new we(s))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[(hn=new WeakMap,ln=new WeakMap,pn=new WeakMap,kc=Uc,_y)](){return`Multiaddr(${la(this.bytes)})`}};function Kc(t){return new we(t)}function Mc(t,e){let r=(n,i)=>n.toString().localeCompare(i.toString());return t.length!==e.length?!1:(e.sort(r),t.sort(r).every((n,i)=>e[i].equals(n)))}var dn;(function(t){let e;(function(n){let i;n.codec=()=>(i==null&&(i=Tr((s,a,o={})=>{o.lengthDelimited!==!1&&a.fork(),s.multiaddr!=null&&s.multiaddr.byteLength>0&&(a.uint32(10),a.bytes(s.multiaddr)),o.lengthDelimited!==!1&&a.ldelim()},(s,a)=>{let o={multiaddr:new Uint8Array(0)},f=a==null?s.len:s.pos+a;for(;s.pos<f;){let c=s.uint32();switch(c>>>3){case 1:o.multiaddr=s.bytes();break;default:s.skipType(c&7);break}}return o})),i),n.encode=s=>Cr(s,n.codec()),n.decode=s=>Ar(s,n.codec())})(e=t.AddressInfo||(t.AddressInfo={}));let r;t.codec=()=>(r==null&&(r=Tr((n,i,s={})=>{if(s.lengthDelimited!==!1&&i.fork(),n.peerId!=null&&n.peerId.byteLength>0&&(i.uint32(10),i.bytes(n.peerId)),n.seq!=null&&n.seq!==0n&&(i.uint32(16),i.uint64(n.seq)),n.addresses!=null)for(let a of n.addresses)i.uint32(26),t.AddressInfo.codec().encode(a,i);s.lengthDelimited!==!1&&i.ldelim()},(n,i)=>{let s={peerId:new Uint8Array(0),seq:0n,addresses:[]},a=i==null?n.len:n.pos+i;for(;n.pos<a;){let o=n.uint32();switch(o>>>3){case 1:s.peerId=n.bytes();break;case 2:s.seq=n.uint64();break;case 3:s.addresses.push(t.AddressInfo.codec().decode(n,n.uint32()));break;default:n.skipType(o&7);break}}return s})),r),t.encode=n=>Cr(n,t.codec()),t.decode=n=>Ar(n,t.codec())})(dn||(dn={}));var Oc="libp2p-peer-record",Fc=Uint8Array.from([3,1]);var qt=class{constructor(e){this.domain=qt.DOMAIN,this.codec=qt.CODEC;let{peerId:r,multiaddrs:n,seqNumber:i}=e;this.peerId=r,this.multiaddrs=n??[],this.seqNumber=i??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=dn.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))})),this.marshaled}equals(e){return!(!(e instanceof qt)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!Mc(this.multiaddrs,e.multiaddrs))}};qt.createFromProtobuf=t=>{let e=dn.decode(t),r=ra(e.peerId),n=(e.addresses??[]).map(s=>Kc(s.multiaddr)),i=e.seq;return new qt({peerId:r,multiaddrs:n,seqNumber:i})};qt.DOMAIN=Oc;qt.CODEC=Fc;return Wc(Ly);})();
/*! Bundled license information:

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerRecord}));
